<!-- This file was generated by mk_f90_html_help.pro -->
<html>
 
<head>
<TITLE>Module Documentation</TITLE>
</head>
 
<body>
<H1>Module Documentation</H1>
<P>
<STRONG>Last modified: </STRONG>Mon Mar 28 14:37:29 2005.<P>
 
<HR>
 
<A NAME="MODULELIST">
<H1>List of Modules</H1></A>
<UL>
<LI><A HREF="#CRTM_ATMSCATTER_DEFINE">CRTM_ATMSCATTER_DEFINE</A>
<LI><A HREF="#CRTM_AEROSOLSCATTER">CRTM_AEROSOLSCATTER</A>
<LI><A HREF="#CRTM_CLOUDSCATTER">CRTM_CLOUDSCATTER</A>
</UL><P>
 
<HR>
 
<H1>Module Descriptions</H1>
<A NAME="CRTM_ATMSCATTER_DEFINE">
<H2>CRTM_ATMSCATTER_DEFINE</H2></A>
<A HREF="#CRTM_AEROSOLSCATTER">[Next Module]</A>
<A HREF="#MODULELIST">[List of Modules]</A>
<PRE>
 NAME:
       CRTM_AtmScatter_Define

 PURPOSE:
       Module defining the CRTM AtmScatter structure and containing
       routines to manipulate it.
       
 CATEGORY:
       CRTM : Scattering

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       USE CRTM_AtmScatter_Define

 MODULES:
       Type_Kinds:             Module containing definitions for kinds
                               of variable types.

       Error_Handler:          Module to define simple error codes and
                               handle error conditions
                               USEs: FILE_UTILITY module

 CONTAINS:
       CRTM_Associated_AtmScatter:  Function to test the association status
                                    of the pointer members of an AtmScatter
                                    structure.

       CRTM_Destroy_AtmScatter:     Function to re-initialize an
                                    CRTM_AtmScatter structure.

       CRTM_Allocate_AtmScatter:    Function to allocate the pointer
                                    members of an CRTM_AtmScatter
                                    structure.

       CRTM_Assign_AtmScatter:      Function to copy an CRTM_AtmScatter
                                    structure.


 DERIVED TYPES:
       CRTM_AtmScatter_type
       --------------------
         Definition of the CRTM scattering data structure.
         Fields are:

         n_Layers:                Number of atmospheric layers.
                                  The &quot;K&quot; dimension.
                                  UNITS:      N/A
                                  TYPE:       INTEGER
                                  DIMENSION:  Scalar

         Max_Legendre_Terms:      The maximum number of Legendre polynomial
                                  terms defined for the AtmScatter structure.
                                  The &quot;Ic&quot; dimension.
                                  UNITS:      N/A
                                  TYPE:       INTEGER
                                  DIMENSION:  Scalar

         n_Legendre_Terms:        The number of Legendre polynomial terms used to
                                  describe the scattering phase function. The
                                  phase function may be written in the form

                                                        __ 2N-1
                                                       \
                                    P(od,cos[Theta]) ~  &gt;  (2l+1).g(l,od).P(l,cos[Theta])
                                                       /__
                                                          l=0

                                  where od      = layer optical depth,
                                        g(l,od) = the Legendre expansion coefficients

                                                   /\+1 
                                               1   |
                                    g(l,od) = ---  |  P(od,cos[Theta]).P(l,cos[Theta]) dcos[Theta]
                                               2   |
                                                  \/ -1

                                  The default is to set
                                    n_Legendre_Terms = Max_Legendre_Terms
                                  The &quot;IcUse&quot; dimension.
                                  UNITS:      N/A
                                  TYPE:       INTEGER
                                  DIMENSION:  Scalar


         Max_Phase_Elements:      The maximum number of phase elements defined
                                  for the AtmScatter structure.
                                  The &quot;Ip&quot; dimension.
                                  UNITS:      N/A
                                  TYPE:       INTEGER
                                  DIMENSION:  Scalar

         n_Phase_Elements:        The number of unique, non-zero elements in the
                                  scattering matrix, *P*. The scattering matrix is a
                                  4x4 matrix that connects the Stokes vectors of the
                                  incident to the scattered radiation. With no
                                  assumptions about shape or position of the scatter,
                                  the phase matrix is

                                          [ P(11)  P(12)  P(13)  P(14) ]
                                          [                            ]
                                          [ P(21)  P(22)  P(23)  P(24) ]
                                    *P* = [                            ]
                                          [ P(31)  P(32)  P(33)  P(34) ]
                                          [                            ]
                                          [ P(41)  P(42)  P(43)  P(44) ]


                                  with 16 unique, non-zero elements. For spherical
                                  particles, *P* becomes,


                                          [ P(11)  P(12)    0      0   ]
                                          [                            ]
                                          [ P(12)  P(11)    0      0   ]
                                    *P* = [                            ]
                                          [   0      0    P(33)  P(34) ]
                                          [                            ]
                                          [   0      0   -P(34)  P(33) ]

                                  and the number of unique, non-zero elements reduces
                                  to 4. The default is to set
                                    n_Phase_Elements = Max_Phase_Elements
                                  The &quot;IpUse&quot; dimension.
                                  UNITS:      N/A
                                  TYPE:       INTEGER
                                  DIMENSION:  Scalar


         Phase_Coefficient:       The coefficients of the Legendre polynomial
                                  used to specify the scattering phase function.
                                  ** NOTE: THIS IS CONSIDERED AN ALGORITHM   **
                                  **       SPECIFIC MEMBER OF THIS STRUCTURE **
                                  UNITS:      N/A
                                  TYPE:       REAL( fp_kind )
                                  DIMENSION:  Rank-3 ( K x Ic x Ip )

         Optical_Depth:           Optical depth for the layer due to the 
                                  prescence of scatters where,
                                    od = k(e) * dA 
                                  and
                                    k(e) = k(s) + k(a)
                                  where k(e) = total extinction coefficient
                                        k(s) = scattering coefficient
                                        k(a) = absorption coefficient
                                        dA   = absorber amount
                                  ** NOTE: THIS IS A MANDATORY MEMBER **
                                  **       OF THIS STRUCTURE          **
                                  UNITS:      N/A
                                  TYPE:       REAL( fp_kind )
                                  DIMENSION:  Rank-1 ( K )


         Single_Scatter_Albedo:   The ratio of the scattering and extinction
                                  coefficient,
                                    ~    k(s)
                                    w = ------
                                         k(e)
                                  ** NOTE: THIS IS A MANDATORY MEMBER **
                                  **       OF THIS STRUCTURE          **
                                  UNITS:      N/A
                                  TYPE:       REAL( fp_kind )
                                  DIMENSION:  Rank-1 ( K )

         Asymmetry_Factor:        The first moment of the phase function
                                  representing the degree of asymmetry of
                                  the angular scattering, g(1,od)
                                  ** NOTE: THIS IS A MANDATORY MEMBER **
                                  **       OF THIS STRUCTURE          **
                                  UNITS:      N/A
                                  TYPE:       REAL( fp_kind )
                                  DIMENSION:  Rank-1 ( K )
                                 
         Delta_Truncation:        The scaling factor associated with the
                                  truncation of the forward scattering peak
                                  in the scattering phase function. Value
                                  ranges from 0 (no truncation, all Legendre
                                  terms used) to 1 (full truncation, no scattering
                                  only absorption.)
                                  ** NOTE: THIS IS A MANDATORY MEMBER **
                                  **       OF THIS STRUCTURE          **
                                  UNITS:      N/A
                                  TYPE:       REAL( fp_kind )
                                  DIMENSION:  Rank-1 ( K )
                                 
       *!IMPORTANT!*
       -------------
       Note that the CRTM_AtmScatter_type is PUBLIC and its members are
       not encapsulated; that is, they can be fully accessed outside the
       scope of this module. This makes it possible to manipulate
       the structure and its data directly rather than, for e.g., via
       get() and set() functions. This was done to eliminate the
       overhead of the get/set type of structure access in using the
       structure. *But*, it is recommended that the user destroy,
       allocate, assign, and concatenate the structure using only
       the routines in this module where possible to eliminate -- or
       at least minimise -- the possibility of memory leakage since
       most of the structure members are pointers.

 INCLUDE FILES:
       None.

 EXTERNALS:
       None.

 COMMON BLOCKS:
       None.

 FILES ACCESSED:
       None.

 CREATION HISTORY:
       Written by:     Yong Han,       NOAA/NESDIS;     Yong.Han@noaa.gov
                       Quanhua Liu,    QSS Group, Inc;  Quanhua.Liu@noaa.gov
                       Paul van Delst, CIMSS/SSEC;      paul.vandelst@ssec.wisc.edu
                       02-Apr-2004

  Copyright (C) 2004 Yong Han, Quanhua Liu, Paul van Delst

  This program is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
</PRE><P>
<STRONG>(See crtm_atmscatter_define.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_AEROSOLSCATTER">
<H2>CRTM_AEROSOLSCATTER</H2></A>
<A HREF="#CRTM_ATMSCATTER_DEFINE">[Previous Module]</A>
<A HREF="#CRTM_CLOUDSCATTER">[Next Module]</A>
<A HREF="#MODULELIST">[List of Modules]</A>
<PRE>
 NAME:
       CRTM_AerosolScatter

 PURPOSE:
       Module to compute the aerosol absorption and scattering properties
       required for radiative transfer in an atmosphere with aerosols.
       
 CATEGORY:
       CRTM : AtmScatter

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       USE CRTM_AerosolScatter

 MODULES:
       Type_Kinds:                Module containing definitions for kinds
                                  of variable types.

       Error_Handler:             Module to define simple error codes and
                                  handle error conditions
                                  USEs: FILE_UTILITY module

       CRTM_Parameters:           Module of parameter definitions for the CRTM.
                                  USEs: TYPE_KINDS module

       CRTM_SpcCoeff:             Module containing the shared CRTM spectral
                                  coefficients (SpcCoeff) and their
                                  load/destruction routines. 
                                  USEs TYPE_KINDS module
                                       ERROR_HANDLER module
                                       SPCCOEFF_DEFINE module
                                       SPCCOEFF_BINARY_IO module
                                       CRTM_PARAMETERS module

       CRTM_AerosolCoeff:         Module containing the shared CRTM aerosol
                                  coefficients (AerosolCoeff) and their
                                  load/destruction routines. 
                                  USEs TYPE_KINDS module
                                       ERROR_HANDLER module
                                       AEROSOLCOEFF_DEFINE module
                                       AEROSOLCOEFF_BINARY_IO module
                                       CRTM_PARAMETERS module

       CRTM_Atmosphere_Define:    Module defining the CRTM Atmosphere
                                  structure and containing routines to 
                                  manipulate it.
                                  USEs: TYPE_KINDS module
                                        ERROR_HANDLER module
                                        CRTM_CLOUD_DEFINE module

       CRTM_GeometryInfo_Define:  Module defining the CRTM GeometryInfo
                                  structure and containing routines to 
                                  manipulate it.
                                  USEs: TYPE_KINDS module
                                        ERROR_HANDLER module

       CRTM_AtmScatter_Define:    Module defining the CRTM AtmScatter
                                  structure and containing routines to 
                                  manipulate it.
                                  USEs: TYPE_KINDS module
                                        ERROR_HANDLER module

 CONTAINS:
       PUBLIC subprograms
       ------------------
         CRTM_Compute_AerosolScatter:     Function to compute aerosol absorption
                                          and scattering properties.

         CRTM_Compute_AerosolScatter_TL:  Function to compute the tangent-linear
                                          aerosol absorption and scattering
                                          properties.

         CRTM_Compute_AerosolScatter_AD:  Function to compute the adjoint
                                          of the aerosol absorption and scattering
                                          properties.

       PRIVATE subprograms
       -------------------
       
         *** USERS ADD INFO HERE FOR ANY PRIVATE SUBPROGRAMS ***



 USE ASSOCIATED PUBLIC SUBPROGRAMS:
       CRTM_Associated_AtmScatter:  Function to test the association status of
                                    the pointer members of a AtmScatter
                                    structure.
                                    SOURCE: CRTM_ATMSCATTER_DEFINE module

       CRTM_Destroy_AtmScatter:     Function to re-initialize an
                                    CRTM_AtmScatter structure.
                                    SOURCE: CRTM_ATMSCATTER_DEFINE module

       CRTM_Allocate_AtmScatter:    Function to allocate the pointer
                                    members of an CRTM_AtmScatter
                                    structure.
                                    SOURCE: CRTM_ATMSCATTER_DEFINE module

       CRTM_Assign_AtmScatter:      Function to copy an CRTM_AtmScatter
                                    structure.
                                    SOURCE: CRTM_ATMSCATTER_DEFINE module

 INCLUDE FILES:
       None.

 EXTERNALS:
       None.

 COMMON BLOCKS:
       None.

 FILES ACCESSED:
       None.

 CREATION HISTORY:
       Written by:     Paul van Delst, CIMSS/SSEC 15-Feb-2005
                       paul.vandelst@ssec.wisc.edu

  Copyright (C) 2005 Paul van Delst

  This program is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
</PRE><P>
<STRONG>(See crtm_aerosolscatter.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_CLOUDSCATTER">
<H2>CRTM_CLOUDSCATTER</H2></A>
<A HREF="#CRTM_AEROSOLSCATTER">[Previous Module]</A>
<A HREF="#MODULELIST">[List of Modules]</A>
<PRE>
 NAME:
       CRTM_CloudScatter

 PURPOSE:
       Module to compute the cloud particle absorption and scattering properties
       required for radiative transfer in a cloudy atmosphere.
       
 CATEGORY:
       CRTM : AtmScatter

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       USE CRTM_CloudScatter

 MODULES:
       Type_Kinds:                Module containing definitions for kinds
                                  of variable types.

       Error_Handler:             Module to define simple error codes and
                                  handle error conditions
                                  USEs: FILE_UTILITY module

       CRTM_Parameters:           Module of parameter definitions for the CRTM.
                                  USEs: TYPE_KINDS module

       CRTM_SpcCoeff:             Module containing the shared CRTM spectral
                                  coefficients (SpcCoeff) and their
                                  load/destruction routines. 
                                  USEs TYPE_KINDS module
                                       ERROR_HANDLER module
                                       SPCCOEFF_DEFINE module
                                       SPCCOEFF_BINARY_IO module
                                       CRTM_PARAMETERS module

       CRTM_ScatterCoeff:         Module containing the shared CRTM scattering
                                  coefficients (ScatterCoeff) and their
                                  load/destruction routines. 
                                  USEs TYPE_KINDS module
                                       ERROR_HANDLER module
                                       SCATTERCOEFF_DEFINE module
                                       SCATTERCOEFF_BINARY_IO module
                                       CRTM_PARAMETERS module

       CRTM_Atmosphere_Define:    Module defining the CRTM Atmosphere
                                  structure and containing routines to 
                                  manipulate it.
                                  USEs: TYPE_KINDS module
                                        ERROR_HANDLER module
                                        CRTM_CLOUD_DEFINE module

       CRTM_GeometryInfo_Define:  Module defining the CRTM GeometryInfo
                                  structure and containing routines to 
                                  manipulate it.
                                  USEs: TYPE_KINDS module
                                        ERROR_HANDLER module

       CRTM_AtmScatter_Define:    Module defining the CRTM AtmScatter
                                  structure and containing routines to 
                                  manipulate it.
                                  USEs: TYPE_KINDS module
                                        ERROR_HANDLER module

 CONTAINS:
       PUBLIC subprograms
       ------------------
         CRTM_Compute_CloudScatter:     Function to compute cloud absorption
                                        and scattering properties.

         CRTM_Compute_CloudScatter_TL:  Function to compute the tangent-linear
                                        cloud absorption and scattering
                                        properties.

         CRTM_Compute_CloudScatter_AD:  Function to compute the adjoint of the
                                        cloud absorption and scattering
                                        properties.

       PRIVATE subprograms
       -------------------
       
         *** USERS ADD INFO HERE FOR ANY PRIVATE SUBPROGRAMS ***



 USE ASSOCIATED PUBLIC SUBPROGRAMS:
       CRTM_Associated_AtmScatter:   Function to test the association status of
                                     the pointer members of a AtmScatter
                                     structure.
                                     SOURCE: CRTM_ATMSCATTER_DEFINE module

       CRTM_Destroy_AtmScatter:      Function to re-initialize an
                                     CRTM_AtmScatter structure.
                                     SOURCE: CRTM_ATMSCATTER_DEFINE module

       CRTM_Allocate_AtmScatter:     Function to allocate the pointer
                                     members of an CRTM_AtmScatter
                                     structure.
                                     SOURCE: CRTM_ATMSCATTER_DEFINE module

       CRTM_Assign_AtmScatter:       Function to copy an CRTM_AtmScatter
                                     structure.
                                       SOURCE: CRTM_ATMSCATTER_DEFINE module

 INCLUDE FILES:
       None.

 EXTERNALS:
       None.

 COMMON BLOCKS:
       None.

 FILES ACCESSED:
       None.

 CREATION HISTORY:
       Written by:     Yong Han,       NOAA/NESDIS;     Yong.Han@noaa.gov
                       Quanhua Liu,    QSS Group, Inc;  Quanhua.Liu@noaa.gov
                       Paul van Delst, CIMSS/SSEC;      paul.vandelst@ssec.wisc.edu
                       02-Apr-2004

  Copyright (C) 2004 Yong Han, Quanhua Liu, Paul van Delst

  This program is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
</PRE><P>
<STRONG>(See crtm_cloudscatter.f90)</STRONG><P>
<HR>
 
</body>
</html>
