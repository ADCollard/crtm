<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>TauCoeff Introduction Page</title>
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script type="text/javascript">
    <!-- Hide script from old browsers -->
    var BName = navigator.appName;
    if (BName != "Microsoft Internet Explorer")  {
      document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"http://cimss.ssec.wisc.edu/~paulv/StyleSheets/contents.css\">")
    }
    else {
      document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"http://cimss.ssec.wisc.edu/~paulv/StyleSheets/IEcontents.css\">")
    }
    ;
  </script>
</head>
<body>
<h1 class="main"><a name="TOP"></a>TauCoeff Introduction Page</h1>

<hr width="100%">
<p>TauCoeff files and data structures contain the coefficients and ancillary
data to compute atmospheric layer optical depth due to gaseous absorption via a
fast model as part of the
<a href="http://www.jcsda.noaa.gov">Joint Center for Satellite Data Assimilation</a>
(JCSDA) Community Radiative Transfer Model (CRTM). This page describes the data
structure and data file formats.

<p>As the optical depth computation algorithm is worked on and improved, or even
replaced, this webpage will relfect those changes. Currently the algorithm used
to compute the layer optical depths is OPTRAN.



<!-- =========================================================== -->
<h2><a name="TAUCOEFF_DATA_CONTENTS"></a>TauCoeff Data Contents</h2>
<!-- =========================================================== -->

TauCoeff files and data structures contain the following data,
 
<p>
<table border="1" cols="3" width="750" cellpadding="5">
  <tbody>
    <tr>
      <th>Name</th>
      <th colspan="2">Description</th>
    </tr>
    <tr>
      <td align="center">Release</td>
      <td colspan="2">TauCoeff data release number. This value is an
                      indicator of the data file and structure format.</td>
    </tr>
    <tr>
      <td align="center">Version</td>
      <td colspan="2">TauCoeff data version number. This value is an
                      indicator of the age or methodology used to produce the data values.</td>
    </tr>
    <tr>
      <td align="center">n_Orders</td>
      <td colspan="2">Maximum polynomial order used to reconstruct the regression
                      coefficients. "<code>Iorder</code>" dimension.</td>
    </tr>
    <tr>
      <td align="center">n_Predictors</td>
      <td colspan="2">Number of predictors used in the gas absorption regression.
                      "<code>Iuse</code>" dimension.</td>
    </tr>
    <tr>
      <td align="center">n_Absorbers</td>
      <td colspan="2">Number of gaseous absorbers. "<code>J</code>" dimension.</td>
    </tr>
    <tr>
      <td align="center">n_Channels</td>
      <td colspan="2">Number of spectral channels. "<code>L</code>" dimension.</td>
    </tr>
    <tr>
      <td align="center">n_Sensors</td>
      <td colspan="2">Number of different satellite/sensors represented
                      in the data file and structure.</td>
    </tr>
    <tr>
      <td align="center">Sensor_Descriptor</td>
      <td colspan="2">String variable (20 characters in length)
                      containing a short text description of the
                      sensor and satellite. Descriptors are taken
                      from the SensorInfo file prefix member. Examples are:
                      <ul>
                        <li>hirs3_n17 </li>
                        <li>airs_aqua </li>
                        <li>ssmis_f16 </li>
                        <li>etc... </li>
                      </ul></td>
    </tr>
    <tr>
      <td align="center">NCEP_Sensor_ID</td>
      <td colspan="2">An array of "in-house" values used at
                      NOAA/NCEP/EMC to identify a satellite/sensor combination. Each sensor 
                      channel in the file and structure has a value.</td>                   
    </tr>
    <tr>
      <td align="center">WMO_Satellite_ID</td>
      <td colspan="2">An array of WMO code values identifying satelite
                      platforms. Taken from the
                      <a href="http://www.wmo.ch/web/ddbs/Code-tables.html" target="_blank">WMO common code tables</a>.
                      The Satellite ID is from Common Code table C-5,
                      or code table 0 01 007 in BUFR. Each sensor channel in the file and
                      structure has a value.</td>
    </tr>
    <tr>
      <td align="center">WMO_Sensor_ID</td>
      <td colspan="2">An array of WMO code values identifying a
                      satelite sensor. Taken from the
                      <a href="http://www.wmo.ch/web/ddbs/Code-tables.html" target="_blank">WMO common code tables</a>.
                      The Sensor ID is from Common Code table C-8, or
                      code table 0 02 019 in BUFR. Each sensor channel in the file and
                      structure has a value.</td>
    </tr>
    <tr>
      <td align="center">Sensor_Channel</td>
      <td colspan="2">An array of sensor channel numbers. May not
                      contain contiguous values.</td>
    </tr>
    <tr>
      <td align="center">Absorber_ID</td>
      <td colspan="2">Array containing a list of absorber ID
                      values. Used to identify the individual
                      or collective molecular species for which
                      the gas absorption coefficients were
                      generated.</td>
    </tr>
    <tr>
      <td align="center">Alpha</td>
      <td colspan="2">Array containing the alpha values used to
                      generate the absorber space levels for each absorber.</td>
    </tr>
    <tr>
      <td align="center">Alpha_C1</td>
      <td colspan="2">First constant (slope) used in defining the
                      Alpha to absorber space equation:
                      <br><code>  A(k) = Alpha_C1 * EXP( Alpha * k )  +  Alpha_C2</code>
                      <br>where
                      <br><code>  k</code> = layer variable
                      <br><code>  A</code> = absorber amount.</td>
    </tr>
    <tr>
      <td align="center">Alpha_C2</td>
      <td colspan="2">Second constant (offset) used in defining the
                      Alpha to absorber space equation:
                      <br><code>  A(k) = Alpha_C1 * EXP( Alpha * k )  +  Alpha_C2</code>
                      <br>where
                      <br><code>  k</code> = layer variable
                      <br><code>  A</code> = absorber amount.</td>
    </tr>
    <tr>
      <td align="center">Order_Index</td>
      <td colspan="2">Array containing the polynomial orders to use
                      in reconstructing the gas absorption model
                      regression coefficients.</td>
    </tr>
    <tr>
      <td align="center">Predictor_Index</td>
      <td colspan="2">Array containing the predictor indices
                      used to identify which predictors to use
                      in the gas absorption model.</td>
    </tr>
    <tr>
      <td align="center">C</td>
      <td colspan="2">Array containing the gas absorption
                      model coefficients.</td>
    </tr>
  </tbody>
</table>



<!-- ======================================================================== -->
<h2><a name="TAUCOEFF_STRUCTURE_DEFINITION"></a>TauCoeff Structure Defintion</h2>
<!-- ======================================================================== -->

<p>The TauCoeff structure is defined in the
<a href="Modules.html#TAUCOEFF_DEFINE"><code>TauCoeff_Define</code></a>
module.
 
<pre>
  TYPE, PUBLIC :: TauCoeff_type
    INTEGER :: n_Allocates = 0

    ! -- Release and version information
    INTEGER( Long ) :: Release = TAUCOEFF_RELEASE
    INTEGER( Long ) :: Version = TAUCOEFF_VERSION

    ! -- Array dimensions
    INTEGER( Long ) :: n_Orders     = 0    ! Iorder
    INTEGER( Long ) :: n_Predictors = 0    ! Iuse
    INTEGER( Long ) :: n_Absorbers  = 0    ! J
    INTEGER( Long ) :: n_Channels   = 0    ! L

    INTEGER( Long ) :: Sensor_Descriptor_StrLen = DL

    ! -- Number of different satellite/sensor combinations
    INTEGER( Long ) :: n_Sensors = 0

    ! -- The satellite and sensor IDs
    CHARACTER( DL ), POINTER, DIMENSION( : ) :: Sensor_Descriptor => NULL() ! L
    INTEGER( Long ), POINTER, DIMENSION( : ) :: NCEP_Sensor_ID    => NULL() ! L
    INTEGER( Long ), POINTER, DIMENSION( : ) :: WMO_Satellite_ID  => NULL() ! L
    INTEGER( Long ), POINTER, DIMENSION( : ) :: WMO_Sensor_ID     => NULL() ! L

    ! -- The actual sensor channel numbers
    INTEGER( Long ), POINTER, DIMENSION( : ) :: Sensor_Channel => NULL()    ! L

    ! -- The absorber ID
    INTEGER( Long ), POINTER, DIMENSION( : ) :: Absorber_ID => NULL()    ! J

    ! -- The absorber space function values
    REAL( Double ),  POINTER, DIMENSION( : ) :: Alpha    => NULL()       ! J
    REAL( Double ),  POINTER, DIMENSION( : ) :: Alpha_C1 => NULL()       ! J
    REAL( Double ),  POINTER, DIMENSION( : ) :: Alpha_C2 => NULL()       ! J

    ! -- The polynomial order and predictor index arrays.
    INTEGER( Long ), POINTER, DIMENSION( :, :, : ) :: Order_Index     => NULL()  ! 0:Iuse x J x L
    INTEGER( Long ), POINTER, DIMENSION( :, :, : ) :: Predictor_Index => NULL()  ! 0:Iuse x J x L

    ! -- The array of coefficients
    REAL( Double ),  POINTER, DIMENSION( :, :, :, : ) :: C => NULL() ! 0:Iorder x 0:Iuse x J x L
  END TYPE TauCoeff_type
</pre>

<p>The current <code>TAUCOEFF_RELEASE</code> is 5 and the current <code>TAUCOEFF_VERSION</code>
is 3. Note that the format of the structure and the datafiles only changes with a release update.
Version changes affect the data, but not the structure or datafiles formats.

<p>The <code>TauCoeff_type</code> is PUBLIC and its members are not
encapsulated; that is, they can be fully accessed outside the scope of
the <code>TauCoeff_Define</code> module. This makes it possible to
manipulate the structure and its data directly rather than, for e.g.,
via <code>get()</code> and <code>set()</code> functions. This was done to
eliminate the overhead of the get/set type of access in using the
structure. <em><strong>But</strong></em>, it is recommended that the
user destroy, allocate, assign, and concatenate the
structure using the routines in <code>TauCoeff_Define</code> module where
possible to eliminate -- or at least minimise -- the possibility of
memory leakage since most of the structure members are pointers.
 
<p>The floating point components are defined with the <code>Double</code>
kind type rather than the generic <code>fp_kind</code> kind type and the
integer components are explicitly type as <code>Long</code>. This is done
to ensure the binary datafiles are read and written consistently.
 
<p>The <code>n_Allocates</code> structure component is only used
internally in the structure allocation and destruction functions to
keep track of the current allocation status of the structure.



<!-- ========================================================= -->
<h2><a name="TAUCOEFF_FILE_FORMATS"></a>TauCoeff File Formats</h2>
<!-- ========================================================= -->

<h3><a name="TAUCOEFF_NETCDF_FILE_FORMAT"></a>netCDF Format</h3>

<p>This is the default format for TauCoeff data files. Using netCDF
allows users to track the history, release, and version of the data
file relatively easily via global attributes, as well as the attributes
of the contents themselves.
 
<p>These datafiles are read and written using the functions in the
<a href="TauCoeff_netCDF_IO.f90.html"><code>TauCoeff_netCDF_IO</code></a>
module. They are created via the
<a href="./Create_IR_TauCoeff/Create_IR_TauCoeff.f90.Program.html"><code>Create_IR_TauCoeff</code></a>
and
<a href="./Create_MW_TauCoeff/Create_MW_TauCoeff.f90.Program.html"><code>Create_MW_TauCoeff</code></a>
programs.
 
<p>Below is the CDL representation of the netCDF format TauCoeff data
file for NOAA-17 HIRS/3,

<pre>
netcdf hirs3_n17.TauCoeff {
dimensions:
	n_Orders = 11 ;
	n_Predictors = 7 ;
	n_Channels = 19 ;
	n_Absorbers = 3 ;
	sdsl = 20 ;
variables:
	int Release ;
		Release:long_name = "Release number of TauCoeff data file" ;
	int Version ;
		Version:long_name = "Version number of TauCoeff data file" ;
	char Sensor_Descriptor(n_Channels, sdsl) ;
		Sensor_Descriptor:long_name = "Short text string containing the sensor/satellite description" ;
	int NCEP_Sensor_ID(n_Channels) ;
		NCEP_Sensor_ID:long_name = "ID used at NOAA/NCEP/EMC to identify a satellite/sensor" ;
	int WMO_Satellite_ID(n_Channels) ;
		WMO_Satellite_ID:long_name = "WMO code for identifying satellite platforms" ;
	int WMO_Sensor_ID(n_Channels) ;
		WMO_Sensor_ID:long_name = "WMO code for identifying a satellite sensor" ;
	int Sensor_Channel(n_Channels) ;
		Sensor_Channel:long_name = "List of sensor channel numbers associated with the TauCoeff data" ;
	int Absorber_ID(n_Absorbers) ;
		Absorber_ID:long_name = "List of absorber ID values for distinguishing the absorber type." ;
		Absorber_ID:units = "N/A" ;
	double Alpha(n_Absorbers) ;
		Alpha:long_name = "Alpha values used to generate the absorber space levels." ;
		Alpha:units = "Absorber dependent." ;
	double Alpha_C1(n_Absorbers) ;
		Alpha_C1:long_name = "First constant (slope) used in defining the Alpha to absorber space equation." ;
		Alpha_C1:units = "Absorber dependent." ;
	double Alpha_C2(n_Absorbers) ;
		Alpha_C2:long_name = "Second constant (offset) used in defining the Alpha to absorber space equation." ;
		Alpha_C2:units = "Absorber dependent." ;
	int Order_Index(n_Channels, n_Absorbers, n_Predictors) ;
		Order_Index:long_name = "Index list of polynomial orders to use in the transmittance calculation." ;
		Order_Index:units = "N/A" ;
	int Predictor_Index(n_Channels, n_Absorbers, n_Predictors) ;
		Predictor_Index:long_name = "Index list of predictors to use in the transmittance calculation." ;
		Predictor_Index:units = "N/A" ;
	double Tau_Coefficients(n_Channels, n_Absorbers, n_Predictors, n_Orders) ;
		Tau_Coefficients:long_name = "Regression model transmittance coefficients." ;
		Tau_Coefficients:units = "Absorber and predictor dependent." ;

// global attributes:
		:write_module_history = "$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $" ;
		:creation_date_and_time = "2004/05/18, 14:48:18 -0400UTC" ;
		:title = "upwelling transmittance coefficients" ;
		:history = "$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $; $Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $:$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $:$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $; LBLRTM v7.04; HITRAN 2000 + AER updates$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $; $Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $; $Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $:AER extract_solar.f;$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $;$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $:$Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $; $Id: Introduction.html,v 1.2 2005/05/10 17:38:19 paulv Exp $" ;
		:sensor_name = "HIRS/3" ;
		:platform_name = "NOAA-17" ;
		:comment = "Coefficients computed from transmittances calculated using LBLRTM v7.04 and HITRAN2000+AER_updates" ;
		:id_tag = "UMBC" ;
}
</pre>


<h3><a name="TAUCOEFF_BINARY_FILE_FORMAT"></a>Binary (sequential,unformatted) Format</h3>

<p>This is the data file format used in operational applications that
require the TauCoeff data, e.g. the CRTM in the Global Data Assimilation System at NCEP/EMC.
 
<p>These datafiles are read and written using the functions in the
<a href="TauCoeff_Binary_IO.f90.html"><code>TauCoeff_Binary_IO</code></a>
module. They are created from the netCDF format data files via the
<a href="./TauCoeff_NC2BIN/TauCoeff_NC2BIN.f90.Program.html"><code>TauCoeff_NC2BIN</code></a>
conversion program.
 
<p>The contents of the binary format datafiles are effectively the same
as the netCDF datafiles but with no attribute data and some extra
header data to check the variable definitions and endian-ness of the
files.  

<p>
<table border="1" cols="8" width="800" cellpadding="5" nosave="">
    <tr nosave="">
      <th>Record Number</th>
      <th colspan="4">Record Contents</th>
      <th>Record Length (bytes)</th>
      <th colspan="2">Record Description</th>
    </tr>
    <tr>
      <td align="center">1</td>
      <td colspan="4"><code>INTEGER( Long ) :: Magic_Number</code></td>
      <td align="center">4</td>
      <td colspan="2">Value used to check endian-ness</td>
    </tr>
    <tr>
      <td align="center">2</td>
      <td colspan="4"><code>INTEGER( Long ) :: Release </code><br>
                      <code>INTEGER( Long ) :: Version</code></td>
      <td align="center">8</td>
      <td colspan="2">Values used to check data format and history</td>
    </tr>
    <tr>
      <td align="center">3</td>
      <td colspan="4"><code>INTEGER( Long ) :: n_Orders</code><br>
                      <code>INTEGER( Long ) :: n_Predictors</code><br>
                      <code>INTEGER( Long ) :: n_Absorbers</code><br>
                      <code>INTEGER( Long ) :: n_Channels</code></td>
      <td align="center">4</td>
      <td colspan="2">Dimensions of the various data.</td>
    </tr>
    <tr>
      <td align="center">4</td>
      <td colspan="4"><code>INTEGER( Long ) :: Sensor_Descriptor_StrLen</code></td>
      <td align="center">4</td>
      <td colspan="2">The length of the sensor descriptor string.</td>
    </tr>
    <tr>
      <td align="center">5</td>
      <td colspan="4"><code>INTEGER( Long ) :: n_Items</code></td>
      <td align="center">4</td>
      <td colspan="2">Number of components in the TauCoeff structure.
                      This value is only used internally to the binary I/O software for
                      verification purposes.</td>
    </tr>
    <tr>
      <td align="center">6</td>
      <td colspan="4"><code>INTEGER( Long ), DIMENSION( n_Items ) :: Data_Type</code></td>
      <td align="center">n_Items * 4</td>
      <td colspan="2">The data types of each component of the TauCoeff
                      structure. These values are only used internally to the binary I/O
                      software for verification purposes.</td>
    </tr>
    <tr>
      <td align="center">7</td>
      <td colspan="4"><code>CHARACTER( DL ), DIMENSION( n_Channels ) :: Sensor_Descriptor</code><br>
                      <code>INTEGER( Long ), DIMENSION( n_Channels ) :: NCEP_Sensor_ID</code><br>
                      <code>INTEGER( Long ), DIMENSION( n_Channels ) :: WMO_Satellite_ID</code><br>
                      <code>INTEGER( Long ), DIMENSION( n_Channels ) :: WMO_Sensor_ID</code><br>
                      <code>INTEGER( Long ), DIMENSION( n_Channels ) :: Sensor_Channel</td>
      <td align="center">n_Channels * 36</td>
      <td colspan="2">The satellite and sensor IDs and channel numbers.</td>
    </tr>
    <tr>
      <td align="center">8</td>
      <td colspan="4"><code>INTEGER( Long ), DIMENSION( n_Absorbers ) :: Absorber_ID</code></td>
      <td align="center">n_Absorbers * 4</td>
      <td colspan="2">The absorber ID values for each absorber.</td>
    </tr>
    <tr>
      <td align="center">9</td>
      <td colspan="4"><code>REAL( Double ), DIMENSION( n_Absorbers ) :: Alpha</code><br>
                      <code>REAL( Double ), DIMENSION( n_Absorbers ) :: Alpha_C1</code><br>
                      <code>REAL( Double ), DIMENSION( n_Absorbers ) :: Alpha_C2</td>
      <td align="center">n_Absorbers * 24</td>
      <td colspan="2">The Alpha values used to reconstruct the absorber space for each
                      absorbing species.</td>
    </tr>
    <tr>
      <td align="center">10</td>
      <td colspan="4"><code>INTEGER( Long ), DIMENSION( 0:n_Predictors, &</code><br>
                      <code>                            n_Absorbers,    &</code><br>
                      <code>                            n_Channels      ) :: Order_Index</code><br></td>
      <td align="center">n_Predictors+1 * n_Absorbers * n_Channels * 4</td>
      <td colspan="2">The polynomial order index used in reconstructing the regression coefficients.</td>
    </tr>
    <tr>
      <td align="center">11</td>
      <td colspan="4"><code>INTEGER( Long ), DIMENSION( 0:n_Predictors, &</code><br>
                      <code>                            n_Absorbers,    &</code><br>
                      <code>                            n_Channels      ) :: Predictor_Index</code><br></td>
      <td align="center">n_Predictors+1 * n_Absorbers * n_Channels * 4</td>
      <td colspan="2">The index used in selecting the predictors to use.</td>
    </tr>
    <tr>
      <td align="center">12</td>
      <td colspan="4"><code>REAL( Double ), DIMENSION( 0:n_Orders, &</code><br>
                      <code>                           0:n_Predictors, &</code><br>
                      <code>                           n_Absorbers,    &</code><br>
                      <code>                           n_Channels      ) :: C</code><br></td>
      <td align="center">n_Orders+1 * n_Predictors+1 * n_Absorbers * n_Channels * 8</td>
      <td colspan="2">The gas absorption model coefficients.</td>
    </tr>
</table>
 
<hr width="100%">
<address>This page maintained by <a href="mailto:paul.vandelst@ssec.wisc.edu?subject=TauCoeff Code Introduction">Paul van Delst</a></address>
<br>
Last updated September 10, 2004
<br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br>
</body>
</html>
