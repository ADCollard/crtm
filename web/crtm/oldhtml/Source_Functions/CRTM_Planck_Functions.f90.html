<!-- This file was generated by mk_f90_html_help.pro -->
<html>
 
<head>
<TITLE>CRTM_PLANCK_FUNCTIONS.F90 Subprograms</TITLE>
</head>
 
<body>
<H1>CRTM_PLANCK_FUNCTIONS.F90 Subprograms</H1>
<P>
<STRONG>Last modified: </STRONG>Mon Mar 28 14:37:33 2005.<P>
 
<HR>
 
<A NAME="SUBPROGRAMLIST">
<H1>List of Subprograms</H1></A>
<UL>
<LI><A HREF="#CRTM_PLANCK_RADIANCE">CRTM_PLANCK_RADIANCE</A>
<LI><A HREF="#CRTM_PLANCK_RADIANCE_TL">CRTM_PLANCK_RADIANCE_TL</A>
<LI><A HREF="#CRTM_PLANCK_RADIANCE_AD">CRTM_PLANCK_RADIANCE_AD</A>
<LI><A HREF="#CRTM_PLANCK_TEMPERATURE">CRTM_PLANCK_TEMPERATURE</A>
<LI><A HREF="#CRTM_PLANCK_TEMPERATURE_TL">CRTM_PLANCK_TEMPERATURE_TL</A>
<LI><A HREF="#CRTM_PLANCK_TEMPERATURE_AD">CRTM_PLANCK_TEMPERATURE_AD</A>
</UL><P>
 
<HR>
 
<H1>Subprogram Descriptions</H1>
<A NAME="CRTM_PLANCK_RADIANCE">
<H2>CRTM_PLANCK_RADIANCE</H2></A>
<A HREF="#CRTM_PLANCK_RADIANCE_TL">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Planck_Radiance

 PURPOSE:
       Subroutine to calculate the instrument channel radiance.

 CATEGORY:
       CRTM : Source Functions

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Planck_Radiance( Channel,     &amp;  ! Input
                                  Temperature, &amp;  ! Input
                                  Radiance     )  ! Output

 INPUT ARGUMENTS:
       Channel:     Channel index id. This is a unique index
                    to a (supported) sensor channel. Used to
                    reference the spectral coefficient data
                    in the CRTM_SpcCoeff module.
                    UNITS:      N/A
                    TYPE:       INTEGER
                    DIMENSION:  Scalar
                    ATTRIBUTES: INTENT( IN )

       Temperature: Temperature for which the Planck radiance is
                    to be calculated.
                    UNITS:      Kelvin, K
                    TYPE:       REAL( fp_kind )
                    DIMENSION:  Scalar
                    ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Radiance:    Channel Planck radiance.
                    UNITS:      mW/(m^2.sr.cm^-1)
                    TYPE:       REAL( fp_kind )
                    DIMENSION:  Scalar
                    ATTRIBUTES: INTENT( OUT )

 OPTIONAL OUTPUT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       Spectral coefficients are obtained from the CRTM_SpcCoeff module
       so only radiances for those sensors which are included in the spectral
       coefficient data file can be calculated.

 PROCEDURE:
       First a polychromatic correction is applied to give an effective
       Temperature,

         T_eff = bc1 + ( bc2 * T )

       The sensor radiance is then calculated using the effective temperature:

                       pc1
         R = ------------------------
              EXP( pc2 / T_eff ) - 1

       The bc1, bc2, pc1, and pc2 values are obtained from the 
       CRTM_SpcCoeff module which is filled during the initialisation
       phase.
</PRE><P>
<STRONG>(See CRTM_Planck_Functions.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_PLANCK_RADIANCE_TL">
<H2>CRTM_PLANCK_RADIANCE_TL</H2></A>
<A HREF="#CRTM_PLANCK_RADIANCE">[Previous Subprogram]</A>
<A HREF="#CRTM_PLANCK_RADIANCE_AD">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Planck_Radiance_TL

 PURPOSE:
       Subroutine to calculate the tangent-linear instrument channel radiance.

 CATEGORY:
       CRTM : Source Functions

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Planck_Radiance_TL( Channel,        &amp;  ! Input
                                     Temperature,    &amp;  ! Input
                                     Temperature_TL, &amp;  ! Input
                                     Radiance_TL     )  ! Output

 INPUT ARGUMENTS:
       Channel:        Channel index id. This is a unique index
                       to a (supported) sensor channel.
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Temperature:    Temperature for which the tangent-linear Planck radiance
                       is to be calculated.
                       UNITS:      Kelvin, K
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Temperature_TL: Tangent-linear temperature for which the tangent-linear
                       Planck radiance is required.
                       UNITS:      Kelvin, K
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Radiance_TL:    Tangent-linear Planck radiance.
                       UNITS:      mW/(m^2.sr.cm^-1)
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( OUT )

 OPTIONAL OUTPUT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       Spectral coefficients are obtained from the CRTM_SpcCoeff module
       so only radiances for those sensors which are included in the spectral
       coefficient data file can be calculated.

 PROCEDURE:
       First a polychromatic correction is applied to give an effective
       temperature,

         T_eff = bc1 + ( bc2 . T )

       The sensor tangent-linear radiance is then calculated by first computing
       the exponential term,

          exponential = EXP( pc2 / T_eff )

       and then the actual operator,

                 pc1 . pc2 . bc1 . exponential
         F = ------------------------------------
              ( T_eff . ( exponential - 1 ) )^2

       which is the derivate of the Planck equation wrt temperature. The
       tangent-linear radiance is then determined by,

         dR = F . dT

       where dT is the input tangent-linear temperature.

       The bc1, bc2, pc1, and pc2 values are obtained from the 
       CRTM_SpcCoeff module which is filled during the initialisation
       phase.
</PRE><P>
<STRONG>(See CRTM_Planck_Functions.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_PLANCK_RADIANCE_AD">
<H2>CRTM_PLANCK_RADIANCE_AD</H2></A>
<A HREF="#CRTM_PLANCK_RADIANCE_TL">[Previous Subprogram]</A>
<A HREF="#CRTM_PLANCK_TEMPERATURE">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Planck_Radiance_AD

 PURPOSE:
       Subroutine to calculate the adjoint instrument channel radiance.

 CATEGORY:
       CRTM : Source Functions

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Planck_Radiance_AD( Channel,       &amp;  ! Input
                                     Temperature,   &amp;  ! Input
                                     Radiance_AD,   &amp;  ! Input
                                     Temperature_AD )  ! In/Output

 INPUT ARGUMENTS:
       Channel:        Channel index id. This is a unique index
                       to a (supported) sensor channel.
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Temperature:    Temperature for which the tangent-linear Planck radiance
                       is to be calculated.
                       UNITS:      Kelvin
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Radiance_AD:    Adjoint Planck radiance.
                       UNITS:      mW/(m2.sr.cm-1)
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Temperature_AD: Adjoint Planck temperature
                       UNITS:      Kelvin
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN OUT )

 OPTIONAL OUTPUT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       The input adjoint radiance argument, Radiance_AD, is NOT set to zero
       before returning to the calling routine.

 RESTRICTIONS:
       Spectral coefficients are obtained from the CRTM_SpcCoeff module
       so only radiances for those sensors which are included in the spectral
       coefficient data file can be calculated.

 PROCEDURE:
       First a polychromatic correction is applied to give an effective
       temperature,

         T_eff = bc1 + ( bc2 . T )

       The sensor tangent-linear radiance is then calculated by first computing
       the exponential term,

          exponential = EXP( pc2 / T_eff )

       and then the actual operator,

                 pc1 . pc2 . bc1 . exponential
         F = ------------------------------------
              ( T_eff . ( exponential - 1 ) )^2

       which is the derivate of the Planck equation wrt temperature. The
       adjoint temperature is then determined from,

         T_AD = T_AD + ( F . R_AD )

       where T_AD and R_AD on the LHS are the input adjoint temperature and
       radiance respectively.

       The bc1, bc2, pc1, and pc2 values are obtained from the 
       CRTM_SpcCoeff module which is filled during the initialisation
       phase.
</PRE><P>
<STRONG>(See CRTM_Planck_Functions.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_PLANCK_TEMPERATURE">
<H2>CRTM_PLANCK_TEMPERATURE</H2></A>
<A HREF="#CRTM_PLANCK_RADIANCE_AD">[Previous Subprogram]</A>
<A HREF="#CRTM_PLANCK_TEMPERATURE_TL">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Planck_Temperature

 PURPOSE:
       Subroutine to calculate the instrument channel brightness temperature.

 CATEGORY:
       CRTM : Source Functions

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Planck_Temperature( Channel,    &amp;  ! Input
                                     Radiance,   &amp;  ! Input
                                     Temperature )  ! Output

 INPUT ARGUMENTS:
       Channel:     Channel index id. This is a unique index
                    to a (supported) sensor channel.
                    UNITS:      N/A
                    TYPE:       INTEGER
                    DIMENSION:  Scalar
                    ATTRIBUTES: INTENT( IN )

       Radiance:    Radiance for which the Planck temperature is desired.
                    UNITS:      mW/(m^2.sr.cm^-1)
                    TYPE:       REAL( fp_kind )
                    DIMENSION:  Scalar
                    ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Temperature: Planck temperature.
                    UNITS:      Kelvin, K
                    TYPE:       REAL( fp_kind )
                    DIMENSION:  Scalar
                    ATTRIBUTES: INTENT( IN )

 OPTIONAL OUTPUT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       Spectral coefficients are obtained from the CRTM_SpcCoeff module
       so only temperatures for those sensors which are included in the spectral
       coefficient data file can be calculated.

 PROCEDURE:
       First the effective temperature is calculated from the inverse Planck function,

                        pc2
         T_eff = ------------------
                  LOG( pc1/R + 1 )

       The polychromatic correction is then removed to provide the brightness
       temperature,

              T_eff - bc1
         T = -------------
                  bc2

       The bc1, bc2, pc1, and pc2 values are obtained from the 
       CRTM_SpcCoeff module which is filled during the initialisation
       phase.
</PRE><P>
<STRONG>(See CRTM_Planck_Functions.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_PLANCK_TEMPERATURE_TL">
<H2>CRTM_PLANCK_TEMPERATURE_TL</H2></A>
<A HREF="#CRTM_PLANCK_TEMPERATURE">[Previous Subprogram]</A>
<A HREF="#CRTM_PLANCK_TEMPERATURE_AD">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Planck_Temperature_TL

 PURPOSE:
       Subroutine to calculate the tangent-linear instrument channel
       brightness temperature.

 CATEGORY:
       CRTM : Source Functions

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Planck_Temperature_TL( Channel,       &amp;  ! Input
                                        Radiance,      &amp;  ! Input
                                        Radiance_TL,   &amp;  ! Input
                                        Temperature_TL )  ! Output

 INPUT ARGUMENTS:
       Channel:        Channel index id. This is a unique index
                       to a (supported) sensor channel.
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Radiance:       Radiance at which the tangent-linear Planck temperature
                       is desired.
                       UNITS:      mW/(m^2.sr.cm^-1)
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Radiance_TL:    Tangent-linear radiance for which the tangent-linear
                       Planck temperature is desired.
                       UNITS:      mW/(m^2.sr.cm^-1)
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Temperature_TL: Tangent-linear Planck temperature.
                       UNITS:      Kelvin, K
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL OUTPUT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       Spectral coefficients are obtained from the CRTM_SpcCoeff module
       so only temperatures for those sensors which are included in the spectral
       coefficient data file can be calculated.

 PROCEDURE:
       First the logarithm argument is calculated,

         a = pc1/R + 1

       The inverse Planck function operator is then calculated,

                      pc1 . pc2
         F = ------------------------------
              bc2 . a . ( R . LOG( a ) )^2

       and the tangent-linear temperature is then given by,

         dT = F . dR

       The bc1, bc2, pc1, and pc2 values are obtained from the 
       CRTM_SpcCoeff module which is filled during the initialisation
       phase.
</PRE><P>
<STRONG>(See CRTM_Planck_Functions.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_PLANCK_TEMPERATURE_AD">
<H2>CRTM_PLANCK_TEMPERATURE_AD</H2></A>
<A HREF="#CRTM_PLANCK_TEMPERATURE_TL">[Previous Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Planck_Temperature_AD

 PURPOSE:
       Subroutine to calculate the adjoint instrument channel
       brightness temperature.

 CATEGORY:
       CRTM : Source Functions

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Planck_Temperature_AD( Channel,        &amp;  ! Input
                                        Radiance,       &amp;  ! Input
                                        Temperature_AD, &amp;  ! Input
                                        Radiance_AD     )  ! In/Output

 INPUT ARGUMENTS:
       Channel:        Channel index id. This is a unique index
                       to a (supported) sensor channel.
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Radiance:       Radiance at which the adjoint radiance is desired.
                       UNITS:      mW/(m^2.sr.cm^-1)
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Temperature_AD: Adjoint Planck temperature.
                       UNITS:      Kelvin, K
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Radiance_AD:    Adjoint radiance.
                       UNITS:      K.m^2.sr.cm^-1/mW
                       TYPE:       REAL( fp_kind )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN OUT )

 OPTIONAL OUTPUT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       The input adjoint temperature argument, Temperature_AD, is NOT set to zero
       before returning to the calling routine.

 RESTRICTIONS:
       Spectral coefficients are obtained from the CRTM_SpcCoeff module
       so only temperatures for those sensors which are included in the spectral
       coefficient data file can be calculated.

 PROCEDURE:
       First the logarithm argument is calculated,

         a = pc1/R + 1

       The inverse Planck function operator is then calculated,

                      pc1 . pc2
         F = ------------------------------
              bc2 . a . ( R . LOG( a ) )^2

       which is the derivate of the Planck temperature wrt radiance. The
       adjoint radiance is then determined from,

         R_AD = R_AD + ( F . T_AD )

       where R_AD and T_AD on the LHS are the input adjoint radiance and
       temperature respectively.

       The bc1, bc2, pc1, and pc2 values are obtained from the 
       CRTM_SpcCoeff module which is filled during the initialisation
       phase.
</PRE><P>
<STRONG>(See CRTM_Planck_Functions.f90)</STRONG><P>
<HR>
 
</body>
</html>
