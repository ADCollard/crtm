<!-- This file was generated by mk_f90_html_help.pro -->
<html>
 
<head>
<TITLE>CRTM_ADJOINT_MODULE.F90 Subprograms</TITLE>
</head>
 
<body>
<H1>CRTM_ADJOINT_MODULE.F90 Subprograms</H1>
<P>
<STRONG>Last modified: </STRONG>Mon Mar 28 14:37:28 2005.<P>
 
<HR>
 
<A NAME="SUBPROGRAMLIST">
<H1>List of Subprograms</H1></A>
<UL>
<LI><A HREF="#CRTM_ADJOINT">CRTM_ADJOINT</A>
</UL><P>
 
<HR>
 
<H1>Subprogram Descriptions</H1>
<A NAME="CRTM_ADJOINT">
<H2>CRTM_ADJOINT</H2></A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Adjoint

 PURPOSE:
       Function that calculates the adjoint of top-of-atmosphere (TOA)
       radiances and brightness temperatures for an input atmospheric
       profile or profile set and user specified satellites/channels.

 CATEGORY:
       CRTM

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Adjoint( Atmosphere,                &amp;  ! Input, M
                                    Surface,                   &amp;  ! Input, M
                                    RTSolution_AD,             &amp;  ! Input, L x M 
                                    GeometryInfo,              &amp;  ! Input, M
                                    ChannelInfo,               &amp;  ! Input, Scalar
                                    Atmosphere_AD,             &amp;  ! Output, M
                                    Surface_AD,                &amp;  ! Output, M
                                    RTSolution,                &amp;  ! Output, L x M
                                    RCS_Id       = RCS_Id,     &amp;  ! Revision control
                                    Message_Log  = Message_Log )  ! Error messaging

 INPUT ARGUMENTS:
       Atmosphere:     Structure containing the Atmosphere data.
                       UNITS:      N/A
                       TYPE:       CRTM_Atmosphere_type
                       DIMENSION:  Scalar
                                     or
                                   Rank-1 (M)
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN )

       Surface:        Structure containing the Surface data.
                       UNITS:      N/A
                       TYPE:       CRTM_Surface_type
                       DIMENSION:  Same as input Atmosphere argument.
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN )

       RTSolution_AD:  Structure containing the RT solution adjoint inputs.
                       **NOTE: On EXIT from this function, the contents of
                               this structure may be modified (e.g. set to
                               zero.)
                       UNITS:      N/A
                       TYPE:       CRTM_RTSolution_type
                       DIMENSION:  Rank-1 (L)
                                     or
                                   Rank-2 (L x M)
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN OUT )

       GeometryInfo:   Structure containing the view geometry
                       information.
                       UNITS:      N/A
                       TYPE:       TYPE( CRTM_GeometryInfo_type )
                       DIMENSION:  Same as input Atmosphere argument
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN )

       ChannelInfo:    Structure returned from the CRTM_Init() function
                       that contains the satellite/sesnor channel index
                       information.
                       UNITS:      N/A
                       TYPE:       TYPE( CRTM_ChannelInfo_type )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       Message_Log:    Character string specifying a filename in which any
                       messages will be logged. If not specified, or if an
                       error occurs opening the log file, the default action
                       is to output messages to the screen.
                       UNITS:      N/A
                       TYPE:       CHARACTER( * )
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN ), OPTIONAL

 OUTPUT ARGUMENTS:
       Atmosphere_AD:  Structure containing the adjoint Atmosphere data.
                       **NOTE: On ENTRY to this function, the contents of
                               this structure should be defined (e.g.
                               initialized to some value based on the
                               position of this function in the call chain.)
                       UNITS:      N/A
                       TYPE:       CRTM_Atmosphere_type
                       DIMENSION:  Same as input Atmosphere argument
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN OUT )

       Surface_AD:     Structure containing the tangent-linear Surface data.
                       **NOTE: On ENTRY to this function, the contents of
                               this structure should be defined (e.g.
                               initialized to some value based on the
                               position of this function in the call chain.)
                       UNITS:      N/A
                       TYPE:       CRTM_Surface_type
                       DIMENSION:  Same as input Atmosphere argument
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN OUT )

       RTSolution:     Structure containing the solution to the RT equation
                       for the given inputs.
                       UNITS:      N/A
                       TYPE:       CRTM_RTSolution_type
                       DIMENSION:  Same as input RTSolution_AD argument
                                   See dimensionality table in COMMENTS below.
                       ATTRIBUTES: INTENT( IN OUT )

 OPTIONAL OUTPUT ARGUMENTS:
       RCS_Id:         Character string containing the Revision Control
                       System Id field for the module.
                       UNITS:      N/A
                       TYPE:       CHARACTER(*)
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( OUT ), OPTIONAL

 FUNCTION RESULT:
       Error_Status:   The return value is an integer defining the error status.
                       The error codes are defined in the ERROR_HANDLER module.
                       If == SUCCESS the computation was sucessful
                          == FAILURE an unrecoverable error occurred
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar

 CALLS:
      CRTM_Allocate_AtmAbsorption:    Function to allocate AtmAbsorption
                                      data structures.
                                      SOURCE: CRTM_ATMABSORPTION_DEFINE module

      CRTM_Allocate_AtmScatter:       Function to allocate AtmScatter data
                                      structures.
                                      SOURCE: CRTM_ATMSCATTER_DEFINE module

      CRTM_Allocate_SfcOptics:        Function to allocate SfcOptics data
                                      structures.
                                      SOURCE: CRTM_SFCOPTICS_DEFINE module

      CRTM_SetUp_AtmAbsorption:       Function to prepare the AtmAbsorption
                                      structure for gaseous absorption calculations.
                                      SOURCE: CRTM_ATMABSORPTION module

      CRTM_SetUp_AtmAbsorption_AD:    Function to process the adjoint
                                      AtmAbsorption structure for gaseous absorption
                                      calculations.
                                      SOURCE: CRTM_ATMABSORPTION module

      CRTM_Compute_AtmAbsorption:     Function to compute optical depths due
                                      to gaseuos absorption.
                                      SOURCE: CRTM_ATMABSORPTION module

      CRTM_Compute_AtmAbsorption_AD:  Function to compute the gaseous absorption
                                      optical depth adjoints.
                                      SOURCE: CRTM_ATMABSORPTION module

      CRTM_Compute_AerosolScatter:    Function to compute aerosol absorption
                                      and scattering properties.
                                      SOURCE: CRTM_AEROSOLSCATTER module

      CRTM_Compute_AerosolScatter_AD: Function to compute the adjoint of the aerosol
                                      absorption and scattering properties.
                                      SOURCE: CRTM_AEROSOLSCATTER module

      CRTM_Compute_CloudScatter:      Function to compute cloud particle absorption
                                      and scattering properties.
                                      SOURCE: CRTM_CLOUDSCATTER module

      CRTM_Compute_CloudScatter_AD:   Function to compute the adjoint of the cloud
                                      particle absorption and scattering properties.
                                      SOURCE: CRTM_CLOUDSCATTER module

      CRTM_Compute_SfcOptics:         Function to compute surface emissivities
                                      and reflectivities.
                                      SOURCE: CRTM_SFCOPTICS module

      CRTM_Compute_SfcOptics_AD:      Function to compute the surface
                                      emissivities and reflectivity adjoints.
                                      SOURCE: CRTM_SFCOPTICS module

      CRTM_Compute_RTSolution:        Function to solve the radiative transfer
                                      equation.
                                      SOURCE: CRTM_RTSOLUTION module

      CRTM_Compute_RTSolution_AD:     Function to solve the adjoint radiative
                                      transfer equation.
                                      SOURCE: CRTM_RTSOLUTION module

      Display_Message:                Subroutine to output messages
                                      SOURCE: ERROR_HANDLER module


 SIDE EFFECTS:
      Note that the input adjoint arguments are modified upon exit, and
      the output adjoint arguments must be defined upon entry. This is
      a consequence of the adjoint formulation where, effectively, the
      chain rule is being used and this funtion could reside anywhere
      in the chain of derivative terms.

 RESTRICTIONS:
      None.

 COMMENTS:
       - The folowing tables details the input/output argument dimensionality
         association, where L == n_Channels, M == n_Profiles:

                       INPUTS                      |           OUTPUTS                   
                                                   |                                     
       Atmosphere    RTSolution_AD   GeometryInfo  |   RTSolution    Atmosphere_AD       
        Surface                                    |                  Surface_AD         
    -----------------------------------------------+-------------------------------      
         Scalar           L             Scalar     |       L             Scalar          
                                                   |                                     
           M            L x M             M        |     L x M             M             

         Thus one can process either a single profile or multiple profiles.
         The routines for each specific case above have been overloaded to
         the generic interface described in the header above.

       - Note the INTENT on the output RTSolution, Atmosphere_AD, and
         Surface_AD arguments are IN OUT rather than just OUT. This is
         necessary because the arguments may be defined upon input. To
         prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_Adjoint_Module.f90)</STRONG><P>
<HR>
 
</body>
</html>
