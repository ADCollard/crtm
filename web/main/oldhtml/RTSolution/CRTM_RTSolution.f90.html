<!-- This file was generated by mk_f90_html_help.pro -->
<html>
 
<head>
<TITLE>CRTM_RTSOLUTION.F90 Subprograms</TITLE>
</head>
 
<body>
<H1>CRTM_RTSOLUTION.F90 Subprograms</H1>
<P>
<STRONG>Last modified: </STRONG>Mon Mar 28 14:37:32 2005.<P>
 
<HR>
 
<A NAME="SUBPROGRAMLIST">
<H1>List of Subprograms</H1></A>
<UL>
<LI><A HREF="#CRTM_COMPUTE_RTSOLUTION">CRTM_COMPUTE_RTSOLUTION</A>
<LI><A HREF="#CRTM_COMPUTE_RTSOLUTION_TL">CRTM_COMPUTE_RTSOLUTION_TL</A>
<LI><A HREF="#CRTM_COMPUTE_RTSOLUTION_AD">CRTM_COMPUTE_RTSOLUTION_AD</A>
</UL><P>
 
<HR>
 
<H1>Subprogram Descriptions</H1>
<A NAME="CRTM_COMPUTE_RTSOLUTION">
<H2>CRTM_COMPUTE_RTSOLUTION</H2></A>
<A HREF="#CRTM_COMPUTE_RTSOLUTION_TL">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_RTSolution

 PURPOSE:
       Function to solve the radiative transfer equation.

 CATEGORY:
       CRTM : RT Solution

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Compute_RTSolution( Atmosphere,                &amp;  ! Input
                                               Surface,                   &amp;  ! Input
                                               AtmAbsorption,             &amp;  ! Input
                                               AerosolScatter,            &amp;  ! Input
                                               CloudScatter,              &amp;  ! Input
                                               GeometryInfo,              &amp;  ! Input
                                               Channel_Index,             &amp;  ! Input
                                               RTSolution,                &amp;  ! Output
                                               SfcOptics    = SfcOptics,  &amp;  ! Optional input
                                               Message_Log  = Message_Log )  ! Error messaging

 INPUT ARGUMENTS:
       Atmosphere:     Structure containing the atmospheric state data.
                       UNITS:      N/A
                       TYPE:       CRTM_Atmosphere_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Surface:        Structure containing the surface state data.
                       UNITS:      N/A
                       TYPE:       CRTM_Surface_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       AtmAbsorption:  Structure containing the atmospheric gas absorption
                       data.
                       UNITS:      N/A
                       TYPE:       CRTM_AtmAbsorption_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       AerosolScatter: Structure containing the aerosol absorption and scattering
                       parameter data.
                       UNITS:      N/A
                       TYPE:       CRTM_AtmScatter_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       CloudScatter:   Structure containing the cloud particle absorption and
                       scattering parameter data.
                       UNITS:      N/A
                       TYPE:       CRTM_AtmScatter_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       GeometryInfo:   Structure containing the view geometry data.
                       UNITS:      N/A
                       TYPE:       CRTM_GeometryInfo_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

       Channel_Index:  Channel index id. This is a unique index associated
                       with a (supported) sensor channel used to access the
                       shared coefficient data.
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       SfcOptics:      Structure containing the surface optical properties
                       data. This is provided as an optional input so that
                       the RTSolution code can call the Compute_SfcOptics()
                       if it's not supplied. Specifically, this is for
                       Successive Order of Interaction (SOI) schemes where
                       the angles at which the surface optical properties
                       are required are not known ahead of time.
                       UNITS:      N/A
                       TYPE:       CRTM_SfcOptics_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN ), OPTIONAL

       Message_Log:    Character string specifying a filename in which any
                       messages will be logged. If not specified, or if an
                       error occurs opening the log file, the default action
                       is to output messages to standard output.
                       UNITS:      None
                       TYPE:       CHARACTER(*)
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN ), OPTIONAL


 OUTPUT ARGUMENTS:
       RTSolution:     Structure containing the soluition to the RT equation
                       for the given inputs.
                       UNITS:      N/A
                       TYPE:       CRTM_RTSolution_type
                       DIMENSION:  Scalar
                       ATTRIBUTES: INTENT( IN OUT )

 OPTIONAL OUTUPT ARGUMENTS:
       None.

 FUNCTION RESULT:
       Error_Status:   The return value is an integer defining the error status.
                       The error codes are defined in the ERROR_HANDLER module.
                       If == SUCCESS the computation was sucessful
                          == FAILURE an unrecoverable error occurred
                       UNITS:      N/A
                       TYPE:       INTEGER
                       DIMENSION:  Scalar

 CALLS:



 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       None.

 COMMENTS:
       Note the INTENT on the output RTSolution argument is IN OUT rather than
       just OUT. This is necessary because the argument may be defined upon
       input. To prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_RTSolution.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_RTSOLUTION_TL">
<H2>CRTM_COMPUTE_RTSOLUTION_TL</H2></A>
<A HREF="#CRTM_COMPUTE_RTSOLUTION">[Previous Subprogram]</A>
<A HREF="#CRTM_COMPUTE_RTSOLUTION_AD">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_RTSolution_TL

 PURPOSE:
       Function to solve the tangent-linear radiative transfer equation.

 CATEGORY:
       CRTM : RT Solution

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Compute_RTSolution_TL( Atmosphere,                  &amp;  ! Input
                                                  Surface,                     &amp;  ! Input
                                                  AtmAbsorption,               &amp;  ! Input
                                                  AerosolScatter,              &amp;  ! Input
                                                  CloudScatter,                &amp;  ! Input
                                                  RTSolution,                  &amp;  ! Input
                                                  Atmosphere_TL,               &amp;  ! Input
                                                  Surface_TL,                  &amp;  ! Input
                                                  AtmAbsorption_TL,            &amp;  ! Input
                                                  AerosolScatter_TL,           &amp;  ! Input
                                                  CloudScatter_TL,             &amp;  ! Input
                                                  GeometryInfo,                &amp;  ! Input
                                                  Channel_Index,               &amp;  ! Input
                                                  RTSolution_TL,               &amp;  ! Output
                                                  SfcOptics    = SfcOptics,    &amp;  ! Optional Input
                                                  SfcOptics_TL = SfcOptics_TL, &amp;  ! Optional Input
                                                  Message_Log  = Message_Log   )  ! Error messaging

 INPUT ARGUMENTS:
       Atmosphere:        Structure containing the atmospheric state data.
                          UNITS:      N/A
                          TYPE:       CRTM_Atmosphere_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       Surface:           Structure containing the surface state data.
                          UNITS:      N/A
                          TYPE:       CRTM_Surface_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       AtmAbsorption:     Structure containing the atmospheric gas absorption
                          data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmAbsorption_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       AerosolScatter:    Structure containing the aerosol absorption and scattering
                          data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       CloudScatter:      Structure containing the cloud particle absorption and
                          scattering data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       RTSolution:        Structure containing the solution to the RT equation
                          for the given inputs.
                          UNITS:      N/A
                          TYPE:       CRTM_RTSolution_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       Atmosphere_TL:     Structure containing the tangent-linear atmospheric
                          state data.
                          UNITS:      N/A
                          TYPE:       CRTM_Atmosphere_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       Surface_TL:        Structure containing the tangent-linear surface state data.
                          UNITS:      N/A
                          TYPE:       CRTM_Surface_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       AtmAbsorption_TL:  Structure containing the tangent-linear atmospheric
                          gas absorption data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmAbsorption_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       AerosolScatter_TL: Structure containing the tangent-linear aerosol absorption
                          and scattering data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       CloudScatter_TL:   Structure containing the tangent-linear cloud particle
                          absorption and scattering data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       GeometryInfo:      Structure containing the view geometry data.
                          UNITS:      N/A
                          TYPE:       CRTM_GeometryInfo_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       Channel_Index:     Channel index id. This is a unique index associated
                          with a (supported) sensor channel used to access the
                          shared coefficient data.
                          UNITS:      N/A
                          TYPE:       INTEGER
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       SfcOptics:         Structure containing the surface optical properties
                          data. This is provided as an optional input so that
                          the RTSolution code can call the Compute_SfcOptics()
                          if it's not supplied. Specifically, this is for
                          Successive Order of Interaction (SOI) schemes where
                          the angles at which the surface optical properties
                          are required are not known ahead of time.
                          UNITS:      N/A
                          TYPE:       CRTM_SfcOptics_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN ), OPTIONAL

       SfcOptics_TL:      Structure containing the tangent-linear surface
                          optical properties data. This is provided as an optional
                          input so that the RTSolution code can call the
                          Compute_SfcOptics_TL() if it's not supplied. Specifically,
                          this is for Successive Order of Interaction (SOI) schemes
                          where the angles at which the surface optical properties
                          are required are not known ahead of time.
                          UNITS:      N/A
                          TYPE:       CRTM_SfcOptics_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN ), OPTIONAL

       Message_Log:       Character string specifying a filename in which any
                          messages will be logged. If not specified, or if an
                          error occurs opening the log file, the default action
                          is to output messages to standard output.
                          UNITS:      None
                          TYPE:       CHARACTER(*)
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN ), OPTIONAL


 OUTPUT ARGUMENTS:
       RTSolution_TL:     Structure containing the solution to the tangent-linear
                          RT equation for the given inputs.
                          UNITS:      N/A
                          TYPE:       CRTM_RTSolution_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )

 OPTIONAL OUTUPT ARGUMENTS:
       None.

 FUNCTION RESULT:
       Error_Status:      The return value is an integer defining the error status
                          The error codes are defined in the ERROR_HANDLER module.
                          If == SUCCESS the computation was sucessful
                             == FAILURE an unrecoverable error occurred
                          UNITS:      N/A
                          TYPE:       INTEGER
                          DIMENSION:  Scalar

 CALLS:



 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       None.

 COMMENTS:
       Note the INTENT on the output RTSolution_TL argument is IN OUT rather
       than just OUT. This is necessary because the argument may be defined
       upon input. To prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_RTSolution.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_RTSOLUTION_AD">
<H2>CRTM_COMPUTE_RTSOLUTION_AD</H2></A>
<A HREF="#CRTM_COMPUTE_RTSOLUTION_TL">[Previous Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_RTSolution_AD

 PURPOSE:
       Function to solve the adjoint radiative transfer equation.

 CATEGORY:
       CRTM : RT Solution

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Compute_RTSolution_AD( Atmosphere,                  &amp;  ! Input
                                                  Surface,                     &amp;  ! Input 
                                                  AtmAbsorption,               &amp;  ! Input 
                                                  AerosolScatter,              &amp;  ! Input 
                                                  CloudScatter,                &amp;  ! Input 
                                                  RTSolution,                  &amp;  ! Input 
                                                  RTSolution_AD,               &amp;  ! Input 
                                                  GeometryInfo,                &amp;  ! Input 
                                                  Channel_Index,               &amp;  ! Input 
                                                  Atmosphere_AD,               &amp;  ! Output
                                                  Surface_AD,                  &amp;  ! Output
                                                  AtmAbsorption_AD,            &amp;  ! Output
                                                  AerosolScatter_AD,           &amp;  ! Output
                                                  CloudScatter_AD,             &amp;  ! Output
                                                  SfcOptics    = SfcOptics,    &amp;  ! Optional input  
                                                  SfcOptics_AD = SfcOptics_AD, &amp;  ! Optional output 
                                                  Message_Log  = Message_Log   )  ! Error messaging

 INPUT ARGUMENTS:
       Atmosphere:        Structure containing the atmospheric state data.
                          UNITS:      N/A
                          TYPE:       CRTM_Atmosphere_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       Surface:           Structure containing the surface state data.
                          UNITS:      N/A
                          TYPE:       CRTM_Surface_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       AtmAbsorption:     Structure containing the atmospheric gas absorption
                          data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmAbsorption_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       AerosolScatter:    Structure containing the aerosol absorption and scattering
                          data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       CloudScatter:      Structure containing the cloud particle absorption and
                          scattering data.
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       RTSolution:        Structure containing the solution to the RT equation
                          for the given inputs.
                          UNITS:      N/A
                          TYPE:       CRTM_RTSolution_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       RTSolution_AD:     Structure containing the RT solution adjoint inputs.
                          **NOTE: On EXIT from this function, the contents of
                                  this structure may be modified (e.g. set to
                                  zero.)
                          UNITS:      N/A
                          TYPE:       CRTM_RTSolution_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )

       GeometryInfo:      Structure containing the view geometry data.
                          UNITS:      N/A
                          TYPE:       CRTM_GeometryInfo_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

       Channel_Index:     Channel index id. This is a unique index associated
                          with a (supported) sensor channel used to access the
                          shared coefficient data.
                          UNITS:      N/A
                          TYPE:       INTEGER
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       SfcOptics:         Structure containing the surface optical properties
                          data. This is provided as an optional input so that
                          the RTSolution code can call the Compute_SfcOptics()
                          if it's not supplied. Specifically, this is for
                          Successive Order of Interaction (SOI) schemes where
                          the angles at which the surface optical properties
                          are required are not known ahead of time.
                          UNITS:      N/A
                          TYPE:       CRTM_SfcOptics_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN ), OPTIONAL

       Message_Log:       Character string specifying a filename in which any
                          messages will be logged. If not specified, or if an
                          error occurs opening the log file, the default action
                          is to output messages to standard output.
                          UNITS:      None
                          TYPE:       CHARACTER(*)
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN ), OPTIONAL


 OUTPUT ARGUMENTS:
       Atmosphere_AD:     Structure containing the adjoint atmospheric
                          state data.
                          **NOTE: On ENTRY to this function, the contents of
                                  this structure should be defined (e.g.
                                  initialized to some value based on the
                                  position of this function in the call chain.)
                          UNITS:      N/A
                          TYPE:       CRTM_Atmosphere_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )

       Surface_AD:        Structure containing the adjoint surface state data.
                          **NOTE: On ENTRY to this function, the contents of
                                  this structure should be defined (e.g.
                                  initialized to some value based on the
                                  position of this function in the call chain.)
                          UNITS:      N/A
                          TYPE:       CRTM_Surface_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )

       AtmAbsorption_AD:  Structure containing the adjoint atmospheric
                          gas absorption data.
                          **NOTE: On ENTRY to this function, the contents of
                                  this structure should be defined (e.g.
                                  initialized to some value based on the
                                  position of this function in the call chain.)
                          UNITS:      N/A
                          TYPE:       CRTM_AtmAbsorption_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )

       AerosolScatter_AD: Structure containing the adjoint aerosol absorption
                          and scattering data.
                          **NOTE: On ENTRY to this function, the contents of
                                  this structure should be defined (e.g.
                                  initialized to some value based on the
                                  position of this function in the call chain.)
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )

       CloudScatter_AD:   Structure containing the adjoint cloud particle absorption
                          and scattering data.
                          **NOTE: On ENTRY to this function, the contents of
                                  this structure should be defined (e.g.
                                  initialized to some value based on the
                                  position of this function in the call chain.)
                          UNITS:      N/A
                          TYPE:       CRTM_AtmScatter_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:
       SfcOptics_AD:      Structure containing the adjoint surface
                          optical properties data. This is provided as an optional
                          input so that the RTSolution code can call the
                          Compute_SfcOptics_AD() if it's not supplied. Specifically,
                          this is for Successive Order of Interaction (SOI) schemes
                          where the angles at which the surface optical properties
                          are required are not known ahead of time.
                          **NOTE: If used, then on ENTRY to this function, the
                                  contents of this structure should be defined
                                  (e.g. initialized to some value based on the
                                  position of this function in the call chain.)
                          UNITS:      N/A
                          TYPE:       CRTM_SfcOptics_type
                          DIMENSION:  Scalar
                          ATTRIBUTES: INTENT( IN OUT ), OPTIONAL


 FUNCTION RESULT:
       Error_Status:      The return value is an integer defining the error status
                          The error codes are defined in the ERROR_HANDLER module.
                          If == SUCCESS the computation was sucessful
                             == FAILURE an unrecoverable error occurred
                          UNITS:      N/A
                          TYPE:       INTEGER
                          DIMENSION:  Scalar

 CALLS:



 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       None.

 COMMENTS:
       Note the INTENT on all of the adjoint arguments (whether input or output)
       is IN OUT rather than just OUT. This is necessary because the INPUT
       adjoint arguments are modified, and the OUTPUT adjoint arguments must
       be defined prior to entry to this routine. So, anytime a structure is
       to be output, to prevent memory leaks the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_RTSolution.f90)</STRONG><P>
<HR>
 
</body>
</html>
