<!-- This file was generated by mk_f90_html_help.pro -->
<html>
 
<head>
<TITLE>CRTM_SFCOPTICS.F90 Subprograms</TITLE>
</head>
 
<body>
<H1>CRTM_SFCOPTICS.F90 Subprograms</H1>
<P>
<STRONG>Last modified: </STRONG>Wed Jun 29 16:36:09 2005.<P>
 
<HR>
 
<A NAME="SUBPROGRAMLIST">
<H1>List of Subprograms</H1></A>
<UL>
<LI><A HREF="#CRTM_COMPUTE_SURFACET">CRTM_COMPUTE_SURFACET</A>
<LI><A HREF="#CRTM_COMPUTE_SURFACET_TL">CRTM_COMPUTE_SURFACET_TL</A>
<LI><A HREF="#CRTM_COMPUTE_SURFACET_AD">CRTM_COMPUTE_SURFACET_AD</A>
<LI><A HREF="#CRTM_COMPUTE_SFCOPTICS">CRTM_COMPUTE_SFCOPTICS</A>
<LI><A HREF="#CRTM_COMPUTE_SFCOPTICS_TL">CRTM_COMPUTE_SFCOPTICS_TL</A>
<LI><A HREF="#CRTM_COMPUTE_SFCOPTICS_AD">CRTM_COMPUTE_SFCOPTICS_AD</A>
</UL><P>
 
<HR>
 
<H1>Subprogram Descriptions</H1>
<A NAME="CRTM_COMPUTE_SURFACET">
<H2>CRTM_COMPUTE_SURFACET</H2></A>
<A HREF="#CRTM_COMPUTE_SURFACET_TL">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_SurfaceT

 PURPOSE:
       Subroutine to compute the average of the various surface type
       temperatures weighted by their coverage fraction.

 CATEGORY:
       CRTM : Surface Optical Properties

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Compute_SurfaceT( Surface,  &amp;  ! Input
                                   SfcOptics )  ! Output     

 INPUT ARGUMENTS:
       Surface:         CRTM_Surface structure containing the surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       SfcOptics:       CRTM_SfcOptics structure containing the surface
                        temperature required for the radiative
                        transfer calculation.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       None.

 COMMENTS:
       Note the INTENT on the output SfcOptics argument is IN OUT rather
       than just OUT. This is necessary because the argument may be defined
       upon input. To prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_SfcOptics.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_SURFACET_TL">
<H2>CRTM_COMPUTE_SURFACET_TL</H2></A>
<A HREF="#CRTM_COMPUTE_SURFACET">[Previous Subprogram]</A>
<A HREF="#CRTM_COMPUTE_SURFACET_AD">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_SurfaceT_TL

 PURPOSE:
       Subroutine to compute the tangent-linear average of the various
       surface type temperatures weighted by their coverage fraction.

 CATEGORY:
       CRTM : Surface Optical Properties

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Compute_SurfaceT_TL( Surface,     &amp;  ! Input
                                      Surface_TL,  &amp;  ! Input     
                                      SfcOptics_TL )  ! In/Output     

 INPUT ARGUMENTS:
       Surface:         CRTM_Surface structure containing the surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       Surface_TL:      CRTM_Surface structure containing the tangent-linerar
                        surface state data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       SfcOptics_TL:    CRTM_SfcOptics structure containing the tangent-linear
                        surface temperature required for the radiative
                        transfer calculation.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       None.

 RESTRICTIONS:
       None.

 COMMENTS:
       Note the INTENT on the output SfcOptics argument is IN OUT rather
       than just OUT. This is necessary because the argument may be defined
       upon input. To prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_SfcOptics.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_SURFACET_AD">
<H2>CRTM_COMPUTE_SURFACET_AD</H2></A>
<A HREF="#CRTM_COMPUTE_SURFACET_TL">[Previous Subprogram]</A>
<A HREF="#CRTM_COMPUTE_SFCOPTICS">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_SurfaceT_AD

 PURPOSE:
       Subroutine to compute the adjoint of the average of the various
       surface type temperatures weighted by their coverage fraction.

 CATEGORY:
       CRTM : Surface Optical Properties

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       CALL CRTM_Compute_SurfaceT_AD( Surface,      &amp;  ! Input
                                      SfcOptics_AD, &amp;  ! Input
                                      Surface_AD    )  ! Output

 INPUT ARGUMENTS:
       Surface:         CRTM_Surface structure containing the surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       SfcOptics_AD:    CRTM_SfcOptics structure containing the adjoint
                        surface temperature required for the radiative
                        transfer calculation.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )

 OPTIONAL INPUT ARGUMENTS:
       None.

 OUTPUT ARGUMENTS:
       Surface_AD:      CRTM_Surface structure containing the adjoint surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:
       None.

 CALLS:
       None.

 SIDE EFFECTS:
       Even though the SfcOptics_AD argument is listed as an INPUT, its
       INTENT is ( IN OUT ) as it is modified on output since the
       Surface_Temperature component is set to zero after the adjoint
       calculation.

       Even though the Surface_AD argument is listed as an OUTPUT, its
       INTENT is ( IN OUT ) as the components of the adjoint calculation
       in this routine may already have a value from a previous adjoint
       calculation performed on the structure.

 RESTRICTIONS:
       None.

 COMMENTS:
       In addition to the input/output requirements described in the SIDE
       EFFECTS section, the SfcOptics_AD and Surface_AD arguments require
       an INTENT of IN OUT to prevent memory leaks.

</PRE><P>
<STRONG>(See CRTM_SfcOptics.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_SFCOPTICS">
<H2>CRTM_COMPUTE_SFCOPTICS</H2></A>
<A HREF="#CRTM_COMPUTE_SURFACET_AD">[Previous Subprogram]</A>
<A HREF="#CRTM_COMPUTE_SFCOPTICS_TL">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_SfcOptics

 PURPOSE:
       Function to compute the surface optical properties and populate
       the output SfcOptics structure for a single channel.

 CATEGORY:
       CRTM : Surface Optical Properties

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Compute_SfcOptics( Surface,                  &amp;  ! Input
                                              GeometryInfo,             &amp;  ! Input
                                              Channel_Index,            &amp;  ! Input, scalar
                                              SfcOptics,                &amp;  ! Output     
                                              Message_Log = Message_Log )  ! Error messaging 

 INPUT ARGUMENTS:
       Surface:         CRTM_Surface structure containing the surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       GeometryInfo:    CRTM_GeometryInfo structure containing the 
                        view geometry information.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_GeometryInfo_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       Channel_Index:   Channel index id. This is a unique index associated
                        with a (supported) sensor channel used to access the
                        shared coefficient data.
                        UNITS:      N/A
                        TYPE:       INTEGER
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )


 OPTIONAL INPUT ARGUMENTS:
       Message_Log:     Character string specifying a filename in which any
                        messages will be logged. If not specified, or if an
                        error occurs opening the log file, the default action
                        is to output messages to standard output.
                        UNITS:      None
                        TYPE:       CHARACTER(*)
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN ), OPTIONAL

 OUTPUT ARGUMENTS:
       SfcOptics:       CRTM_SfcOptics structure containing the surface
                        optical properties required for the radiative
                        transfer calculation.
                        On Input:  The Secant_Angle component is assumed to
                                   contain data.
                        On Output: The Emissivity and Reflectivity components
                                   will contain the required data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:

 FUNCTION RESULT:
       Error_Status:    The return value is an integer defining the error status.
                        The error codes are defined in the ERROR_HANDLER module.
                        If == SUCCESS the computation was sucessful
                           == FAILURE an unrecoverable error occurred
                        UNITS:      N/A
                        TYPE:       INTEGER
                        DIMENSION:  Scalar

 CALLS:

 SIDE EFFECTS:

 RESTRICTIONS:
       None of the input or output structures are checked in this routine as
       it will be called for every channel.

 COMMENTS:
       Note the INTENT on the output SfcOptics argument is IN OUT rather
       than just OUT. This is necessary because the argument should be defined
       upon input. To prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_SfcOptics.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_SFCOPTICS_TL">
<H2>CRTM_COMPUTE_SFCOPTICS_TL</H2></A>
<A HREF="#CRTM_COMPUTE_SFCOPTICS">[Previous Subprogram]</A>
<A HREF="#CRTM_COMPUTE_SFCOPTICS_AD">[Next Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_SfcOptics_TL

 PURPOSE:
       Function to compute the tangent-linear surface optical properties
       and populate the output SfcOptics_TL structure for a single channel.

 CATEGORY:
       CRTM : Surface Optical Properties

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Compute_SfcOptics_TL( Surface,                  &amp;  ! Input
                                                 SfcOptics,                &amp;  ! Input     
                                                 Surface_TL,               &amp;  ! Input
                                                 GeometryInfo,             &amp;  ! Input
                                                 Channel_Index,            &amp;  ! Input, scalar
                                                 SfcOptics_TL,             &amp;  ! In/Output     
                                                 Message_Log = Message_Log )  ! Error messaging 

 INPUT ARGUMENTS:
       Surface:         CRTM_Surface structure containing the surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       SfcOptics:       CRTM_SfcOptics structure containing the surface
                        optical properties required for the radiative
                        transfer calculation.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       Surface_TL:      CRTM_Surface structure containing the tangent-linear
                        surface state data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       GeometryInfo:    CRTM_GeometryInfo structure containing the 
                        view geometry information.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_GeometryInfo_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       Channel_Index:   Channel index id. This is a unique index associated
                        with a (supported) sensor channel used to access the
                        shared coefficient data.
                        UNITS:      N/A
                        TYPE:       INTEGER
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )


 OPTIONAL INPUT ARGUMENTS:
       Message_Log:     Character string specifying a filename in which any
                        messages will be logged. If not specified, or if an
                        error occurs opening the log file, the default action
                        is to output messages to standard output.
                        UNITS:      None
                        TYPE:       CHARACTER(*)
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN ), OPTIONAL

 OUTPUT ARGUMENTS:
       SfcOptics_TL:    CRTM_SfcOptics structure containing the tangent-linear
                        surface optical properties required for the radiative
                        transfer calculation.
                        On Input:  The Secant_Angle component is assumed to
                                   contain data.
                        On Output: The Emissivity and Reflectivity components
                                   will contain the required data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:

 FUNCTION RESULT:
       Error_Status:    The return value is an integer defining the error status.
                        The error codes are defined in the ERROR_HANDLER module.
                        If == SUCCESS the computation was sucessful
                           == FAILURE an unrecoverable error occurred
                        UNITS:      N/A
                        TYPE:       INTEGER
                        DIMENSION:  Scalar

 CALLS:

 SIDE EFFECTS:

 RESTRICTIONS:
       None of the input or output structures are checked in this routine as
       it will be called for every channel.

 COMMENTS:
       Note the INTENT on the output SfcOptics_TL argument is IN OUT rather
       than just OUT. This is necessary because the argument should be defined
       upon input. To prevent memory leaks, the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_SfcOptics.f90)</STRONG><P>
<HR>
 
<A NAME="CRTM_COMPUTE_SFCOPTICS_AD">
<H2>CRTM_COMPUTE_SFCOPTICS_AD</H2></A>
<A HREF="#CRTM_COMPUTE_SFCOPTICS_TL">[Previous Subprogram]</A>
<A HREF="#SUBPROGRAMLIST">[List of Subprograms]</A>
<PRE>
 NAME:
       CRTM_Compute_SfcOptics_AD

 PURPOSE:
       Function to compute the adjoint surface optical properties
       for a single channel.

 CATEGORY:
       CRTM : Surface Optical Properties

 LANGUAGE:
       Fortran-95

 CALLING SEQUENCE:
       Error_Status = CRTM_Compute_SfcOptics_AD( Surface,                  &amp;  ! Input
                                                 SfcOptics,                &amp;  ! Input
                                                 SfcOptics_AD,             &amp;  ! Input
                                                 GeometryInfo,             &amp;  ! Input
                                                 Channel_Index,            &amp;  ! Input
                                                 Surface_AD,               &amp;  ! Output
                                                 Message_Log = Message_Log )  ! Error messaging

 INPUT ARGUMENTS:
       Surface:         CRTM_Surface structure containing the surface state
                        data.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       SfcOptics:       CRTM_SfcOptics structure containing the surface
                        optical properties required for the radiative
                        transfer calculation.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       SfcOptics_AD:    CRTM_SfcOptics structure containing the adjoint
                        surface optical properties.
                        **NOTE: On EXIT from this function, the contents of
                                this structure may be modified (e.g. set to
                                zero.)
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_SfcOptics_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )

       GeometryInfo:    CRTM_GeometryInfo structure containing the 
                        view geometry information.
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_GeometryInfo_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )

       Channel_Index:   Channel index id. This is a unique index associated
                        with a (supported) sensor channel used to access the
                        shared coefficient data.
                        UNITS:      N/A
                        TYPE:       INTEGER
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN )


 OPTIONAL INPUT ARGUMENTS:
       Message_Log:     Character string specifying a filename in which any
                        messages will be logged. If not specified, or if an
                        error occurs opening the log file, the default action
                        is to output messages to standard output.
                        UNITS:      None
                        TYPE:       CHARACTER(*)
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN ), OPTIONAL

 OUTPUT ARGUMENTS:
       Surface_AD:      CRTM_Surface structure containing the adjoint
                        surface state data.
                        **NOTE: On ENTRY to this function, the contents of
                                this structure should be defined (e.g.
                                initialized to some value based on the
                                position of this function in the call chain.)
                        UNITS:      N/A
                        TYPE:       TYPE( CRTM_Surface_type )
                        DIMENSION:  Scalar
                        ATTRIBUTES: INTENT( IN OUT )


 OPTIONAL OUTUPT ARGUMENTS:

 FUNCTION RESULT:
       Error_Status:    The return value is an integer defining the error status.
                        The error codes are defined in the ERROR_HANDLER module.
                        If == SUCCESS the computation was sucessful
                           == FAILURE an unrecoverable error occurred
                        UNITS:      N/A
                        TYPE:       INTEGER
                        DIMENSION:  Scalar

 CALLS:

 SIDE EFFECTS:

 RESTRICTIONS:

 COMMENTS:
       Note the INTENT on all of the adjoint arguments (whether input or output)
       is IN OUT rather than just OUT. This is necessary because the INPUT
       adjoint arguments are modified, and the OUTPUT adjoint arguments must
       be defined prior to entry to this routine. So, anytime a structure is
       to be output, to prevent memory leaks the IN OUT INTENT is a must.

</PRE><P>
<STRONG>(See CRTM_SfcOptics.f90)</STRONG><P>
<HR>
 
</body>
</html>
