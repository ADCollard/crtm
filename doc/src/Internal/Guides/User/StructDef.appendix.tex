\chapter{Structure definitions}
%==============================

\clearpage
\section{\ChannelInfo{} Structure}
%=================================
\label{sec:channelinfo_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_ChannelInfo_type
    ! Dimension values
    INTEGER :: n_Channels = 0  ! L dimension
    ! Scalar data
    CHARACTER(STRLEN) :: Sensor_ID        = ' '
    INTEGER           :: WMO_Satellite_ID = INVALID_WMO_SATELLITE_ID
    INTEGER           :: WMO_Sensor_ID    = INVALID_WMO_SENSOR_ID
    INTEGER           :: Sensor_Index     = 0
    ! Array data
    INTEGER,  POINTER :: Sensor_Channel(:) => NULL()  ! L
    INTEGER,  POINTER :: Channel_Index(:)  => NULL()  ! L
  END TYPE CRTM_ChannelInfo_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \ChannelInfo{} structure definition.}
  \label{fig:channelinfo_structure}
\end{figure}

% ChannelInfo component description table
\begin{table}[htp]
  \centering
  \begin{tabular}{l p{8cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Channels}  & Number of sensor channels (\texttt{L}) & N/A & Scalar \\
    \texttt{Sensor\_Id} & The sensor and platform identifier character string & N/A & Scalar \\
    \texttt{WMO\_Satellite\_Id} & The WMO satellite identifier & N/A & Scalar \\
    \texttt{WMO\_Sensor\_Id} & The WMO sensor identifier & N/A & Scalar \\
    \texttt{Sensor\_Index} & The index of the current structure in an array. Set during CRTM initialisation & N/A & Scalar \\
    \texttt{Sensor\_Channel} & The channel numbers of the current sensor & N/A & \texttt{L}\\
    \texttt{Channel\_Index} & The indices of the selected channels for the current sensors. Currently, all channels are indexed. & N/A & \texttt{L}\\
    \hline
  \end{tabular}
  \caption{CRTM \ChannelInfo{} structure component description.}
  \label{tab:chanelinfo_structure}
\end{table}

\clearpage
\section{\Atmosphere{} Structure}
%================================
\label{sec:atmosphere_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_Atmosphere_type
    ! Dimension values
    INTEGER :: n_Layers     = 0  ! K dimension
    INTEGER :: n_Absorbers  = 0  ! J dimension
    INTEGER :: n_Clouds     = 0  ! Nc dimension
    INTEGER :: n_Aerosols   = 0  ! Na dimension
    ! Number of added layers
    INTEGER :: n_Added_Layers = 0
    ! Climatology model associated with the profile
    INTEGER :: Climatology = INVALID_MODEL
    ! Absorber ID and units
    INTEGER, POINTER :: Absorber_ID(:)    => NULL() ! J
    INTEGER, POINTER :: Absorber_Units(:) => NULL() ! J
    ! Profile LEVEL and LAYER quantities
    REAL(fp), POINTER :: Level_Pressure(:) => NULL()  ! 0:K
    REAL(fp), POINTER :: Pressure(:)       => NULL()  ! K
    REAL(fp), POINTER :: Temperature(:)    => NULL()  ! K
    REAL(fp), POINTER :: Absorber(:,:)     => NULL()  ! K x J
    ! Clouds associated with each profile
    TYPE(CRTM_Cloud_type),   POINTER :: Cloud(:)   => NULL()  ! Nc
    ! Aerosols associated with each profile
    TYPE(CRTM_Aerosol_type), POINTER :: Aerosol(:) => NULL()  ! Na
  END TYPE CRTM_Atmosphere_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \Atmosphere{} structure definition.}
  \label{fig:atmosphere_structure}
\end{figure}

% Atmosphere component description table
\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Layers}    & Number of atmospheric profile layers (\texttt{K}) & N/A & Scalar \\
    \texttt{n\_Absorbers} & Number of atmospheric absorbers (\texttt{J}) & N/A & Scalar \\
    \texttt{n\_Clouds}    & Number of clouds (\texttt{Nc}) & N/A & Scalar \\
    \texttt{n\_Aerosols}  & Number of aerosols (\texttt{Na}) & N/A & Scalar \\
    \texttt{n\_Added\_Layers} & Number of layers added so as to extend the input profile to nominal TOA  & N/A & Scalar \\
    \texttt{Climatology} & Climatology of the profile (see table \ref{tab:climatology}) & N/A & Scalar \\
    \texttt{Absorber\_Id} & Gaseous absorber identifiers (see table \ref{tab:absorber_id}) & N/A & \texttt{J}\\
    \texttt{Absorber\_Units} & Gaseous absorber amount units (see table \ref{tab:absorber_units}) & N/A & \texttt{J}\\
    \texttt{Level\_Pressure} & Interface pressures of the profile layers & hPa & \texttt{0:K} \\
    \texttt{Pressure} & Average layer pressure & hPa & \texttt{K} \\
    \texttt{Temperatures} & Layer temperatures & Kelvin & \texttt{K} \\
    \texttt{Absorbers} & Layer absorber amount & Variable & \texttt{K} $\times$ \texttt{J}\\
    \texttt{Cloud} & Cloud structure array & N/A & \texttt{Nc}\\
    \texttt{Aerosol} & Aerosol structure array & N/A & \texttt{Na}\\
    \hline
  \end{tabular}
  \caption{CRTM \Atmosphere{} structure component description.}
  \label{tab:atmosphere_structure}
\end{table}

% Climatology table
\begin{table}[htp]
  \centering
  \begin{tabular}{c l}
    \hline
    \sffamily\textbf{Climatology Type} & \sffamily\textbf{Parameter} \\
    \hline\hline
             Tropical          &  \texttt{TROPICAL}\\              
        Midlatitude summer     &  \texttt{MIDLATITUDE\_SUMMER}\\
        Midlatitude winter     &  \texttt{MIDLATITUDE\_WINTER}\\
         Subarctic summer      &  \texttt{SUBARCTIC\_SUMMER}\\
         Subarctic winter      &  \texttt{SUBARCTIC\_WINTER}\\
     U.S. Standard Atmosphere  &  \texttt{US\_STANDARD\_ATMOSPHERE}\\
    \hline 
  \end{tabular}
  \caption{CRTM \Atmosphere{} structure valid \texttt{Climatology} definitions. The same set as defined for LBLRTM is used.}
  \label{tab:climatology}
\end{table}

% Absorber id table
\begin{table}
  \centering
  \begin{tabular}{ c l c c l }
    \hline
    \sffamily\textbf{Molecule} & \sffamily\textbf{Parameter} & \hspace{0.5cm} & \sffamily\textbf{Molecule} & \sffamily\textbf{Parameter}\\
    \hline\hline
     H\subscript{2}O  & \texttt{H2O\_ID}  & \hspace{0.5cm} & HI                           & \texttt{HI\_ID}    \\
     CO\subscript{2}  & \texttt{CO2\_ID}  & \hspace{0.5cm} & ClO                          & \texttt{ClO\_ID}   \\
     O\subscript{3}   & \texttt{O3\_ID}   & \hspace{0.5cm} & OCS                          & \texttt{OCS\_ID}   \\
     N\subscript{2}O  & \texttt{N2O\_ID}  & \hspace{0.5cm} & H\subscript{2}CO             & \texttt{H2CO\_ID}  \\
     CO               & \texttt{CO\_ID}   & \hspace{0.5cm} & HOCl                         & \texttt{HOCl\_ID}  \\
     CH\subscript{4}  & \texttt{CH4\_ID}  & \hspace{0.5cm} & N\subscript{2}               & \texttt{N2\_ID}    \\
     O\subscript{2}   & \texttt{O2\_ID}   & \hspace{0.5cm} & HCN                          & \texttt{HCN\_ID}   \\
     NO               & \texttt{NO\_ID}   & \hspace{0.5cm} & CH\subscript{3}l             & \texttt{CH3l\_ID}  \\
     SO\subscript{2}  & \texttt{SO2\_ID}  & \hspace{0.5cm} & H\subscript{2}O\subscript{2} & \texttt{H2O2\_ID}  \\
     NO\subscript{2}  & \texttt{NO2\_ID}  & \hspace{0.5cm} & C\subscript{2}H\subscript{2} & \texttt{C2H2\_ID}  \\
     NH\subscript{3}  & \texttt{NH3\_ID}  & \hspace{0.5cm} & C\subscript{2}H\subscript{6} & \texttt{C2H6\_ID}  \\
     HNO\subscript{3} & \texttt{HNO3\_ID} & \hspace{0.5cm} & PH\subscript{3}              & \texttt{PH3\_ID}   \\
     OH               & \texttt{OH\_ID}   & \hspace{0.5cm} & COF\subscript{2}             & \texttt{COF2\_ID}  \\
     HF               & \texttt{HF\_ID}   & \hspace{0.5cm} & SF\subscript{6}              & \texttt{SF6\_ID}   \\
     HCl              & \texttt{HCl\_ID}  & \hspace{0.5cm} & H\subscript{2}S              & \texttt{H2S\_ID}   \\
     HBr              & \texttt{HBr\_ID}  & \hspace{0.5cm} & HCOOH                        & \texttt{HCOOH\_ID} \\
    \hline
  \end{tabular}
  \caption{CRTM \Atmosphere{} structure valid \texttt{Absorber\_ID} definitions. The same molecule set as defined for HITRAN is used.}
  \label{tab:absorber_id}
\end{table}

% Absorber units table
\begin{table}
  \centering
  \begin{tabular}{c l}
    \hline
    \sffamily\textbf{Units} & \sffamily\textbf{Parameter} \\
    \hline\hline
     Volume mixing ratio, ppmv                       & \texttt{VOLUME\_MIXING\_RATIO\_UNITS} \\
     Number density, cm$^{-3}$                       & \texttt{NUMBER\_DENSITY\_UNITS} \\
     Mass mixing ratio, g/kg                         & \texttt{MASS\_MIXING\_RATIO\_UNITS} \\
     Mass density, g.m$^{-3}$                        & \texttt{MASS\_DENSITY\_UNITS} \\
     Partial pressure, hPa                           & \texttt{PARTIAL\_PRESSURE\_UNITS} \\
     Dewpoint temperature, K  \textbf{(H$\mathbf{_2}$O ONLY)} & \texttt{DEWPOINT\_TEMPERATURE\_K\_UNITS} \\
     Dewpoint temperature, C  \textbf{(H$\mathbf{_2}$O ONLY)} & \texttt{DEWPOINT\_TEMPERATURE\_C\_UNITS} \\
     Relative humidity, \%    \textbf{(H$\mathbf{_2}$O ONLY)} & \texttt{RELATIVE\_HUMIDITY\_UNITS} \\
     Specific amount, g/g                            & \texttt{SPECIFIC\_AMOUNT\_UNITS} \\
     Integrated path, mm                             & \texttt{INTEGRATED\_PATH\_UNITS} \\
    \hline
  \end{tabular}
  \caption{CRTM \Atmosphere{} structure valid \texttt{Absorber\_Units} definitions. The same set as defined for LBLRTM is used.}
  \label{tab:absorber_units}
\end{table}

\clearpage
\subsection{\Cloud{} Structure}
%------------------------------
\label{sec:cloud_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_Cloud_type
    ! Dimension values
    INTEGER :: n_Layers = 0  ! K dimension.
    ! Number of added layers
    INTEGER :: n_Added_Layers = 0
    ! Cloud type
    INTEGER :: Type = NO_CLOUD
    ! Cloud state variables
    REAL(fp), POINTER :: Effective_Radius(:)   => NULL() ! K
    REAL(fp), POINTER :: Effective_Variance(:) => NULL() ! K
    REAL(fp), POINTER :: Water_Content(:)      => NULL() ! K
  END TYPE CRTM_Cloud_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \Cloud{} structure definition.}
  \label{fig:cloud_structure}
\end{figure}

% Cloud component description table
\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Layers} & Number of atmospheric profile layers (\texttt{K}) & N/A & Scalar \\
    \texttt{n\_Added\_Layers} & Number of layers added so as to extend the input profile to nominal TOA  & N/A & Scalar \\
    \texttt{Type} & Type of cloud (see table \ref{tab:cloud_type}) & N/A & Scalar \\
    \texttt{Effective\_Radius} & Cloud particle $r_{eff}$ profile & \micron & \texttt{K} \\
    \texttt{Effective\_Variance} & Cloud particle $\sigma_{eff}$ profile & \micron$^2$ & \texttt{K} \\
    \texttt{Water\_Content} & Cloud water content profile & kg.m$^{-2}$ & \texttt{K} \\
    \hline
  \end{tabular}
  \caption{CRTM \Cloud{} structure component description.}
  \label{tab:cloud_structure}
\end{table}

% Cloud type table
\begin{table}
  \centering
  \begin{tabular}{cc l}
    \hline
    \sffamily\textbf{Cloud Type} & \hspace{0.5cm} & \sffamily\textbf{Parameter} \\
    \hline\hline
     Water   & \hspace{0.5cm} & \texttt{WATER\_CLOUD}\\
     Ice     & \hspace{0.5cm} & \texttt{ICE\_CLOUD}\\
     Rain    & \hspace{0.5cm} & \texttt{RAIN\_CLOUD}\\
     Snow    & \hspace{0.5cm} & \texttt{SNOW\_CLOUD}\\
     Graupel & \hspace{0.5cm} & \texttt{GRAUPEL\_CLOUD}\\
     Hail    & \hspace{0.5cm} & \texttt{HAIL\_CLOUD}\\
    \hline
  \end{tabular}
  \caption{CRTM \Cloud{} structure valid \texttt{Type} definitions.}
  \label{tab:cloud_type}
\end{table}

\clearpage
\subsection{\Aerosol{} Structure}
%--------------------------------
\label{sec:aerosol_structure}


\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_Aerosol_type
    ! Dimensions
    INTEGER :: n_Layers = 0  ! K dimension
    ! Number of added layers    
    INTEGER :: n_Added_Layers = 0
    ! Aerosol type
    INTEGER :: Type = NO_AEROSOL
    ! Aerosol state variables
    REAL(fp), POINTER :: Effective_Radius(:) => NULL()  ! K
    REAL(fp), POINTER :: Concentration(:)    => NULL()  ! K
  END TYPE CRTM_Aerosol_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \Aerosol{} structure definition.}
  \label{fig:aerosol_structure}
\end{figure}

% Aerosol component description table
\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Layers} & Number of atmospheric profile layers (\texttt{K}) & N/A & Scalar \\
    \texttt{n\_Added\_Layers} & Number of layers added so as to extend the input profile to nominal TOA  & N/A & Scalar \\
    \texttt{Type} & Type of Aerosol (see table \ref{tab:aerosol_type}) & N/A & Scalar \\
    \texttt{Effective\_Radius} & Aerosol particle $r_{eff}$ profile & \micron & \texttt{K} \\
    \texttt{Concentration} & Aerosol concentration profile & kg.m$^{-2}$ & \texttt{K} \\
    \hline
  \end{tabular}
  \caption{CRTM \Aerosol{} structure component description.}
  \label{tab:aerosol_structure}
\end{table}

% Aerosol type table
\begin{table}
  \centering
  \begin{tabular}{c l}
    \hline
    \sffamily\textbf{Aerosol Type} & \sffamily\textbf{Parameter} \\
    \hline\hline
           Dust         &  \texttt{DUST\_AEROSOL}\\
       Sea salt SSAM\footnote{SSAM $\equiv$ sea salt accumulation mode, $r_{eff}\sim$0.5-5.0\micron.} &  \texttt{SEASALT\_SSAM\_AEROSOL}\\
       Sea salt SSCM\footnote{SSCM $\equiv$ sea salt coarse mode, $r_{eff}\sim$5.0-30\micron} &  \texttt{SEASALT\_SSCM\_AEROSOL}\\
     Dry organic carbon &  \texttt{DRY\_ORGANIC\_CARBON\_AEROSOL}\\
     Wet organic carbon &  \texttt{WET\_ORGANIC\_CARBON\_AEROSOL}\\
      Dry black carbon  &  \texttt{DRY\_BLACK\_CARBON\_AEROSOL}\\
      Wet black carbon  &  \texttt{WET\_BLACK\_CARBON\_AEROSOL}\\
          Sulfate       &  \texttt{SULFATE\_AEROSOL}\\
    \hline
  \end{tabular}
  \caption{CRTM \Aerosol{} structure valid \texttt{Type} definitions.}
  \label{tab:aerosol_type}
\end{table}


\clearpage
\section{\Surface{} Structure}
%=============================
\label{sec:surface_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_Surface_type
    ! Dimension values
    INTEGER :: n_Sensors    = 0  ! N dimension
    ! Gross type of surface determined by coverage
    REAL(fp) :: Land_Coverage  = ZERO
    REAL(fp) :: Water_Coverage = ZERO
    REAL(fp) :: Snow_Coverage  = ZERO
    REAL(fp) :: Ice_Coverage   = ZERO
    ! Surface type independent data
    REAL(fp) :: Wind_Speed     = DEFAULT_WIND_SPEED
    REAL(fp) :: Wind_Direction = DEFAULT_WIND_DIRECTION
    ! Land surface type data
    INTEGER  :: Land_Type             = DEFAULT_LAND_TYPE
    REAL(fp) :: Land_Temperature      = DEFAULT_LAND_TEMPERATURE
    REAL(fp) :: Soil_Moisture_Content = DEFAULT_SOIL_MOISTURE_CONTENT
    REAL(fp) :: Canopy_Water_Content  = DEFAULT_CANOPY_WATER_CONTENT
    REAL(fp) :: Vegetation_Fraction   = DEFAULT_VEGETATION_FRACTION
    REAL(fp) :: Soil_Temperature      = DEFAULT_SOIL_TEMPERATURE
    ! Water type data
    INTEGER  :: Water_Type        = DEFAULT_WATER_TYPE
    REAL(fp) :: Water_Temperature = DEFAULT_WATER_TEMPERATURE
    REAL(fp) :: Salinity          = DEFAULT_SALINITY
    ! Snow surface type data
    INTEGER  :: Snow_Type        = DEFAULT_SNOW_TYPE
    REAL(fp) :: Snow_Temperature = DEFAULT_SNOW_TEMPERATURE
    REAL(fp) :: Snow_Depth       = DEFAULT_SNOW_DEPTH
    REAL(fp) :: Snow_Density     = DEFAULT_SNOW_DENSITY
    REAL(fp) :: Snow_Grain_Size  = DEFAULT_SNOW_GRAIN_SIZE
    ! Ice surface type data
    INTEGER  :: Ice_Type        = DEFAULT_ICE_TYPE
    REAL(fp) :: Ice_Temperature = DEFAULT_ICE_TEMPERATURE
    REAL(fp) :: Ice_Thickness   = DEFAULT_ICE_THICKNESS
    REAL(fp) :: Ice_Density     = DEFAULT_ICE_DENSITY
    REAL(fp) :: Ice_Roughness   = DEFAULT_ICE_ROUGHNESS
    ! SensorData containing channel brightness temperatures
    TYPE(CRTM_SensorData_type) :: SensorData  ! N
  END TYPE CRTM_Surface_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \Surface{} structure definition.}
  \label{fig:surface_structure}
\end{figure}

\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Sensors} & The number of sensors for which data is provided inside the SensorData structure & N/A & Scalar \\
    \hline
    \texttt{Land\_Coverage}  & Fraction of the FOV that is land surface & N/A & Scalar \\
    \texttt{Water\_Coverage} & Fraction of the FOV that is water surface & N/A & Scalar \\
    \texttt{Snow\_Coverage}  & Fraction of the FOV that is snow surface & N/A & Scalar \\
    \texttt{Ice\_Coverage}   & Fraction of the FOV that is ice surface & N/A & Scalar \\
    \hline
    \texttt{Wind\_Speed}     & Surface wind speed & m.s$^{-1}$ & Scalar \\
    \texttt{Wind\_Direction} & Surface wind direction & deg. E from N & Scalar \\
    \hline
    \texttt{Land\_Type}              & Land surface type & N/A & Scalar \\
    \texttt{Land\_Temperature}       & Land surface temperature & Kelvin & Scalar \\
    \texttt{Soil\_Moisture\_Content} & Volumetric water content of the soil & g.cm$^{-3}$ & Scalar \\
    \texttt{Canopy\_Water\_Content}  & Gravimetric water content of the canopy & g.cm$^{-3}$ & Scalar \\
    \texttt{Vegetation\_Fraction}    & Vegetation fraction of the surface & \% & Scalar \\
    \texttt{Soil\_Temperature}       & Soil temperature & Kelvin & Scalar \\
    \hline
    \texttt{Water\_Type}        & Water surface type & N/A & Scalar \\
    \texttt{Water\_Temperature} & Water surface temperature & Kelvin & Scalar \\
    \texttt{Salinity}           & Water salinity & \textperthousand & Scalar \\
    \hline
    \texttt{Snow\_Type}        & Snow surface type & N/A & Scalar \\ 
    \texttt{Snow\_Temperature} & Snow surface temperature & Kelvin & Scalar \\ 
    \texttt{Snow\_Depth}       & Snow depth & mm & Scalar \\ 
    \texttt{Snow\_Density}     & Snow density & g.m$^{-3}$ & Scalar \\ 
    \texttt{Snow\_Grain\_Size} & Snow grain size & mm & Scalar \\ 
    \hline
    \texttt{Ice\_Type}        & Ice surface type & N/A & Scalar \\ 
    \texttt{Ice\_Temperature} & Ice surface temperature & Kelvin & Scalar \\ 
    \texttt{Ice\_Thickness}   & Thickness of ice & mm & Scalar \\ 
    \texttt{Ice\_Density}     & Density of ice & g.m$^{-3}$ & Scalar \\ 
    \texttt{Ice\_Roughness}   & Measure of the surface roughness of the ice & N/A & Scalar \\ 
    \hline
    \texttt{SensorData} & Satellite sensor data required for some surface emissivity algorithms & N/A & Scalar \\ 
    \hline
  \end{tabular}
  \caption{CRTM \Surface{} structure component description.}
  \label{tav:surface_structure}
\end{table}

% Default surface value table
\begin{table}[htp]
  \centering
  \begin{tabular}{l c c}
    \hline
    \sffamily\textbf{Parameter} & \sffamily\textbf{Value}  & \sffamily\textbf{Units} \\
    \hline\hline
    \multicolumn{3}{c}{\textsf{Surface type independent data}}\\
    \hline
    \texttt{DEFAULT\_WIND\_SPEED}             & 5.0        & m.s$^{-1}$\\
    \texttt{DEFAULT\_WIND\_DIRECTION}         & 0.0        & deg. E from N\\[0.2cm]
    \multicolumn{3}{c}{\textsf{Land surface type data}}\\
    \hline
    \texttt{DEFAULT\_LAND\_TYPE}              & \texttt{GRASS\_SOIL}& N/A \\
    \texttt{DEFAULT\_LAND\_TEMPERATURE}       & 283.0      & K\\
    \texttt{DEFAULT\_SOIL\_MOISTURE\_CONTENT} & 0.05       & g.cm$^{-3}$\\
    \texttt{DEFAULT\_CANOPY\_WATER\_CONTENT}  & 0.05       & g.cm$^{-3}$\\
    \texttt{DEFAULT\_VEGETATION\_FRACTION}    & 0.3        & 30\%\\
    \texttt{DEFAULT\_SOIL\_TEMPERATURE}       & 283.0      & K\\[0.2cm]
    \multicolumn{3}{c}{\textsf{Water type data}}\\
    \hline
    \texttt{DEFAULT\_WATER\_TYPE}             & \texttt{SEA\_WATER} & N/A\\
    \texttt{DEFAULT\_WATER\_TEMPERATURE}      & 283.0      & K\\
    \texttt{DEFAULT\_SALINITY}                & 33.0       & ppmv\\[0.2cm]
    \multicolumn{3}{c}{\textsf{Snow surface type data}}\\
    \hline
    \texttt{DEFAULT\_SNOW\_TYPE}              & \texttt{NEW\_SNOW}  & N/A\\
    \texttt{DEFAULT\_SNOW\_TEMPERATURE}       & 263.0      & K\\
    \texttt{DEFAULT\_SNOW\_DEPTH}             & 50.0       & mm\\
    \texttt{DEFAULT\_SNOW\_DENSITY}           & 0.2        & g.cm$^{-3}$\\
    \texttt{DEFAULT\_SNOW\_GRAIN\_SIZE}       & 2.0        & mm\\[0.2cm]
    \multicolumn{3}{c}{\textsf{Ice surface type data}}\\
    \hline
    \texttt{DEFAULT\_ICE\_TYPE}               & \texttt{FRESH\_ICE} & N/A\\
    \texttt{DEFAULT\_ICE\_TEMPERATURE}        & 263.0      & K\\
    \texttt{DEFAULT\_ICE\_THICKNESS}          & 10.0       & mm\\
    \texttt{DEFAULT\_ICE\_DENSITY}            & 0.9        & g.cm$^{-3}$\\
    \texttt{DEFAULT\_ICE\_ROUGHNESS}          & 0.0        & N/A\\
    \hline
  \end{tabular}
  \caption{CRTM \Surface{} structure default values.}
  \label{tab:surface_default}
\end{table}

% Land surface type table
\begin{table}[htp]
  \centering
  \begin{tabular}{c l}
    \hline
    \sffamily\textbf{Land Type} & \sffamily\textbf{Parameter} \\
    \hline\hline
          Compacted soil      & \texttt{COMPACTED\_SOIL} \\
            Tilled soil       & \texttt{TILLED\_SOIL} \\
              Sand            & \texttt{SAND} \\
              Rock            & \texttt{ROCK} \\
     Irrigated low vegetation & \texttt{IRRIGATED\_LOW\_VEGETATION} \\
           Meadow grass       & \texttt{MEADOW\_GRASS} \\
              Scrub           & \texttt{SCRUB} \\
         Broadleaf forest     & \texttt{BROADLEAF\_FOREST} \\
           Pine forest        & \texttt{PINE\_FOREST} \\
             Tundra           & \texttt{TUNDRA} \\
           Grass soil         & \texttt{GRASS\_SOIL} \\
       Broadleaf-pine forest  & \texttt{BROADLEAF\_PINE\_FOREST} \\
           Grass scrub        & \texttt{GRASS\_SCRUB} \\
            Oil grass         & \texttt{OIL\_GRASS} \\
          Urban concrete      & \texttt{URBAN\_CONCRETE} \\
            Pine brush        & \texttt{PINE\_BRUSH} \\
          Broadleaf brush     & \texttt{BROADLEAF\_BRUSH} \\
             Wet soil         & \texttt{WET\_SOIL} \\
            Scrub soil        & \texttt{SCRUB\_SOIL} \\
      Broadleaf(70)-Pine(30)  & \texttt{BROADLEAF70\_PINE30} \\
    \hline
  \end{tabular}
  \caption{CRTM \Surface{} structure valid \texttt{Land\_Type} definitions.}
  \label{tab:surface_land_type}
\end{table}

% Water surface type table
\begin{table}[htp]
  \centering
  \begin{tabular}{cc l}
    \hline
    \sffamily\textbf{Water Type} & \hspace{0.5cm} & \sffamily\textbf{Parameter} \\
    \hline\hline
      Sea water  & \hspace{0.5cm} &  \texttt{SEA\_WATER} \\     
     Fresh water & \hspace{0.5cm} &  \texttt{FRESH\_WATER} \\   
    \hline
  \end{tabular}
  \caption{CRTM \Surface{} structure valid \texttt{Water\_Type} definitions.}
  \label{tab:surface_water_type}
\end{table}

% Snow surface type table
\begin{table}[htp]
  \centering
  \begin{tabular}{c l}
    \hline
    \sffamily\textbf{Snow Type} & \sffamily\textbf{Parameter} \\
    \hline\hline
         Wet snow          &   \texttt{WET\_SNOW} \\           
      Grass after snow     &   \texttt{GRASS\_AFTER\_SNOW} \\   
        Powder snow        &   \texttt{POWDER\_SNOW} \\        
         RS snow(A)        &   \texttt{RS\_SNOW\_A} \\          
         RS snow(B)        &   \texttt{RS\_SNOW\_B} \\          
         RS snow(C)        &   \texttt{RS\_SNOW\_C} \\          
         RS snow(D)        &   \texttt{RS\_SNOW\_D} \\          
         RS snow(E)        &   \texttt{RS\_SNOW\_E} \\          
      Thin Crust snow      &   \texttt{THIN\_CRUST\_SNOW} \\    
      Thick crust snow     &   \texttt{THICK\_CRUST\_SNOW } \\  
        Shallow snow       &   \texttt{SHALLOW\_SNOW} \\       
         Deep snow         &   \texttt{DEEP\_SNOW} \\          
        Crust snow         &   \texttt{CRUST\_SNOW} \\         
        Medium snow        &   \texttt{MEDIUM\_SNOW} \\        
     Bottom crust snow(A)  &   \texttt{BOTTOM\_CRUST\_SNOW\_A} \\
     Bottom crust snow(B)  &   \texttt{BOTTOM\_CRUST\_SNOW\_B} \\
    \hline
  \end{tabular}
  \caption{CRTM \Surface{} structure valid \texttt{Snow\_Type} definitions.}
  \label{tab:surface_snow_type}
\end{table}

% Ice surface type table
\begin{table}[htp]
  \centering
  \begin{tabular}{c l}
    \hline
    \sffamily\textbf{Ice Type} & \sffamily\textbf{Parameter} \\
    \hline\hline
            Fresh ice        &   \texttt{FRESH\_ICE} \\       
        First year sea ice   &   \texttt{FIRST\_YEAR\_SEA\_ICE} \\
      Multiple year sea ice  &   \texttt{MULTI\_YEAR\_SEA\_ICE} \\
            Ice floe         &   \texttt{ICE\_FLOE} \\            
            Ice ridge        &   \texttt{ICE\_RIDGE} \\           
    \hline
  \end{tabular}
  \caption{CRTM \Surface{} structure valid \texttt{Ice\_Type} definitions.}
  \label{tab:surface_ice_type}
\end{table}


\clearpage
\subsection{\SensorData{} Structure}
%-----------------------------------
\label{sec:sensordata_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE, PUBLIC :: CRTM_SensorData_type
    ! Dimension values
    INTEGER :: n_Channels = 0  ! L
    ! The WMO sensor ID of the sensor for which the data is to be used
    INTEGER :: Select_WMO_Sensor_Id = INVALID_WMO_SENSOR_ID
    ! The data sensor IDs and channels
    CHARACTER(STRLEN), POINTER :: Sensor_Id(:)        => NULL() ! L
    INTEGER,           POINTER :: WMO_Satellite_ID(:) => NULL() ! L
    INTEGER,           POINTER :: WMO_Sensor_ID(:)    => NULL() ! L
    INTEGER,           POINTER :: Sensor_Channel(:)   => NULL() ! L
    ! The sensor brightness temperatures
    REAL(fp),          POINTER :: Tb(:) => NULL() ! L
  END TYPE CRTM_SensorData_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \SensorData{} structure definition.}
  \label{fig:sensordata_structure}
\end{figure}

% SensorData component description table
\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Channels} & Number of channels to use in SfcOptics emissivty algorithms (\texttt{L}) & N/A & Scalar \\
    \texttt{Select\_WMO\_Sensor\_Id} & The WMO Sensor Id value of the sensor for which the data is to be used. & N/A & Scalar \\
    \texttt{Sensor\_Id} & The sensor id character string for each channel of data & N/A & \texttt{L} \\
    \texttt{WMO\_Satellite\_Id} & The WMO satellite Id for each channel of data & N/A & \texttt{L} \\
    \texttt{WMO\_Sensor\_Id} & The WMO sensor Id for each channel of data & N/A & \texttt{L} \\
    \texttt{Sensor\_Channel} & The channel number for each channel of data & N/A & \texttt{L} \\
    \texttt{Tb} & The brightness temperature measurements for each channel & Kelvin & \texttt{L} \\
    \hline
  \end{tabular}
  \caption{CRTM \SensorData{} structure component description.}
  \label{tab:sensordata_structure}
\end{table}



\clearpage
\section{\GeometryInfo{} Structure}
%==================================
\label{sec:geometryinfo_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_GeometryInfo_type
    ! User Input
    ! ----------
    ! Earth location
    REAL(fp) :: Longitude        = ZERO
    REAL(fp) :: Latitude         = ZERO
    REAL(fp) :: Surface_Altitude = ZERO
    ! Field of view index (1-nFOV)
    INTEGER  :: iFOV = 0
    ! Sensor angle information
    REAL(fp) :: Sensor_Scan_Angle    = ZERO
    REAL(fp) :: Sensor_Zenith_Angle  = ZERO
    REAL(fp) :: Sensor_Azimuth_Angle = ZERO 
    ! Source angle information
    REAL(fp) :: Source_Zenith_Angle  = 100.0_fp  ! Below horizon
    REAL(fp) :: Source_Azimuth_Angle = ZERO
    ! Flux angle information
    REAL(fp) :: Flux_Zenith_Angle = DIFFUSIVITY_ANGLE
    ! Derived from User Input
    ! -----------------------
    ! Default distance ratio
    REAL(fp) :: Distance_Ratio = EARTH_RADIUS/(EARTH_RADIUS + SATELLITE_HEIGHT)
    ! Sensor angle information
    REAL(fp) :: Sensor_Scan_Radian    = ZERO
    REAL(fp) :: Sensor_Zenith_Radian  = ZERO
    REAL(fp) :: Sensor_Azimuth_Radian = ZERO
    REAL(fp) :: Secant_Sensor_Zenith  = ZERO
    ! Source angle information
    REAL(fp) :: Source_Zenith_Radian  = ZERO
    REAL(fp) :: Source_Azimuth_Radian = ZERO
    REAL(fp) :: Secant_Source_Zenith  = ZERO
    ! Flux angle information
    REAL(fp) :: Flux_Zenith_Radian = DIFFUSIVITY_RADIAN
    REAL(fp) :: Secant_Flux_Zenith = SECANT_DIFFUSIVITY
  END TYPE CRTM_GeometryInfo_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \GeometryInfo{} structure definition.}
  \label{fig:geometryinfo_structure}
\end{figure}

% GeometryInfo component description table
\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{Longitude}               & Earth longitude & degrees East (0$\rightarrow$360) & Scalar \\
    \texttt{Latitude}                & Earth latitude  & degrees North (-90$\rightarrow$+90) & Scalar \\
    \texttt{Surface\_Altitude}       & Altitude of the Earth's surface at the specified lon/lat location & metres (m) & Scalar \\
    \texttt{iFOV}                    & The scan line FOV index & N/A & Scalar \\
    \texttt{Sensor\_Scan\_Angle}     & The sensor scan angle from nadir. See fig.\ref{fig:gInfo_sensor_scan_angle} & degrees & Scalar \\
    \texttt{Sensor\_Zenith\_Angle}   & The sensor zenith angle of the FOV. See fig.\ref{fig:gInfo_sensor_zenith_angle} & degrees & Scalar \\
    \texttt{Sensor\_Azimuth\_Angle}  & The sensor azimuth angle is the angle subtended by the horizontal projection of a direct line from the satellite to the FOV and the North-South axis measured clockwise from North. See fig.\ref{fig:gInfo_sensor_azimuth_angle} & degrees from North & Scalar \\
    \texttt{Source\_Zenith\_Angle}   & The source zenith angle. The source is typically the Sun (IR/VIS) or Moon (MW/VIS) [only solar source valid in current release] See fig.\ref{fig:gInfo_source_zenith_angle} & degrees & Scalar \\
    \texttt{Source\_Azimuth\_Angle}  & The source azimuth angle is the angle subtended by the horizontal projection of a direct line from the source to the FOV and the North-South axis measured clockwise from North. See fig.\ref{fig:gInfo_source_azimuth_angle} & degrees from North & Scalar \\
    \texttt{Flux\_Zenith\_Angle}     & The zenith angle used to approximate downwelling flux transmissivity. If not set, the default value is that of the diffusivity approximation, such that $\sec(F) = 5/3$. Maximum allowed value is determined from $\sec(F) = 9/4$ & degres & Scalar \\
    \hline
  \end{tabular}
  \caption{Description of CRTM \GeometryInfo{} structure components defined by the user.}
  \label{tab:user_defined_geometryinfo_structure}
\end{table}

\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{Distance\_Ratio}         & The ratio of the radius of the earth at the FOV location to the sum of the radius of the earth at nadir, and the satellite altitude;
    
     \mbox{\hspace{1cm}$r = \displaystyle\frac{R_e(FOV)}{R_e(nadir) + h}$}.
     
     Note that this quantity is actually computed using the user input sensor scan and zenith angles; 
     
     \mbox{\hspace{1cm}$r = \displaystyle\frac{\sin(\theta_{scan})}{\sin(\theta_{zenith})}$} & N/A & Scalar \\
    \texttt{Sensor\_Scan\_Radian}    & The sensor scan angle in radians & radians & Scalar \\
    \texttt{Sensor\_Zenith\_Radian}  & The sensor scan angle in radians & radians & Scalar \\
    \texttt{Sensor\_Azimuth\_Radian} & The sensor azimuth angle in radians & radians & Scalar \\
    \texttt{Secant\_Sensor\_Zenith}  & The secant of the sensor zenith angle & N/A & Scalar \\
    \texttt{Source\_Zenith\_Radian}  & The source zenith angle in radians & radians & Scalar \\
    \texttt{Source\_Azimuth\_Radian} & The source azimuth angle in radians & radians & Scalar \\
    \texttt{Secant\_Source\_Zenith}  & The secant of the source zenith angle & N/A & Scalar \\
    \texttt{Flux\_Zenith\_Radian}    & The flux zenith angle in radians & radians & Scalar \\
    \texttt{Secant\_Flux\_Zenith}    & The secant of the flux zenith angle & N/A & Scalar \\
    \hline
  \end{tabular}
  \caption{Description of CRTM \GeometryInfo{} structure components derived from user inputs.}
  \label{tab:derived_geometryinfo_structure}
\end{table}


\clearpage
\section{\RTSolution{} Structure}
%==================================
\label{sec:rtsolution_structure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
  TYPE :: CRTM_RTSolution_type
    ! Dimension values
    INTEGER :: n_Layers = 0  ! K
    ! Forward radiative transfer intermediate results for a single channel
    !    These components are not defined when they are used as TL, AD
    !    and K variables
    REAL(fp)          :: Surface_Emissivity      = ZERO
    REAL(fp)          :: Up_Radiance             = ZERO
    REAL(fp)          :: Down_Radiance           = ZERO
    REAL(fp)          :: Down_Solar_Radiance     = ZERO
    REAL(fp)          :: Surface_Planck_Radiance = ZERO
    REAL(fp), POINTER :: Upwelling_Radiance(:)  => NULL()  ! K
    ! The layer optical depths
    REAL(fp), POINTER :: Layer_Optical_Depth(:) => NULL()  ! K
    ! Radiative transfer results for a single channel/node
    REAL(fp) :: Radiance               = ZERO
    REAL(fp) :: Brightness_Temperature = ZERO
  END TYPE CRTM_RTSolution_type\end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{CRTM \RTSolution{} structure definition.}
  \label{fig:rtsolution_structure}
\end{figure}

\begin{table}[htp]
  \centering
  \begin{tabular}{l p{7cm} c c}
    \hline
    \sffamily\textbf{Component} & \sffamily\textbf{Description} & \sffamily\textbf{Units} & \sffamily\textbf{Dimensions} \\
    \hline\hline
    \texttt{n\_Layers}    & Number of atmospheric profile layers (\texttt{K}) & N/A & Scalar \\
    \texttt{Surface\_Emissivity      }  & The computed surface emissivity & N/A & Scalar \\
    \texttt{Up\_Radiance             }  & The atmospheric portion of the upwelling radiance & \radunit & Scalar \\
    \texttt{Down\_Radiance           }  & The atmospheric portion of the downwelling radiance & \radunit & Scalar \\
    \texttt{Down\_Solar\_Radiance    }  & The downwelling direct solar radiance & \radunit & Scalar \\
    \texttt{Surface\_Planck\_Radiance}  & The surface radiance & \radunit & Scalar \\
    \texttt{Upwelling\_Radiance      }  & The upwelling radiance profile, including the reflected downwelling and surface contributions. & \radunit & \texttt{K} \\
    \texttt{Layer\_Optical\_Depth    }  & The layer optical depth profile & N/A & \texttt{K} \\
    \texttt{Radiance                 }  & The sensor radiance & \radunit & Scalar \\
    \texttt{Brightness\_Temperature  }  & The sensor brightness temperature & Kelvin & Scalar \\
    \hline
  \end{tabular}
  \caption{CRTM \RTSolution{} structure component description}
  \label{tab:rtsolution_structure}
\end{table}

%
%\section{\Options{} Structure}
%%=============================
%\label{sec:options_structure}
%
%  TYPE :: CRTM_Options_type
%    INTEGER :: n_Allocates = 0
%    ! Dimensions
%    INTEGER :: n_Channels = 0  ! L dimension
%    ! Index into channel-specific components
%    INTEGER :: Channel = 0
%    ! Emissivity optional arguments
%    INTEGER           :: Emissivity_Switch =  NOT_SET
%    REAL(fp), POINTER :: Emissivity(:)     => NULL() ! L
%    ! Direct reflectivity optional arguments
%    INTEGER           :: Direct_Reflectivity_Switch =  NOT_SET
%    REAL(fp), POINTER :: Direct_Reflectivity(:)     => NULL() ! L
%    ! Antenna correction application
%    INTEGER :: Antenna_Correction = NOT_SET
%  END TYPE CRTM_Options_type
