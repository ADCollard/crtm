\subsection{\texttt{CRTM\_AddLayers\_Atmosphere\_AD} interface}
  \label{sec:CRTM_AddLayers_Atmosphere_AD_interface}
  \begin{alltt}
 
  NAME:
        CRTM_AddLayers_Atmosphere_AD
 
  PURPOSE:
        Function to copy back an adjoint atmosphere structure removing added
        extra layers as were required to supplement the upper atmosphere
        profile data.
 
  CALLING SEQUENCE:
        Error_Status = CRTM_AddLayers_Atmosphere_AD( Atm_In                 , &    FWD Input
                                                     Atm_Out_AD             , &    AD  Input
                                                     Atm_In_AD              , &    AD  Output
                                                     Message_Log=Message_Log  )    Error messaging
 
  INPUT ARGUMENTS:
        Atm_In:          Forward model atmosphere structure.
                         UNITS:      N/A
                         TYPE:       CRTM_Atmosphere_type
                         DIMENSION:  Scalar
                         ATTRIBUTES: INTENT(IN)
 
        Atm_Out_AD:      Adjoint atmosphere structure that contains the added
                         extra layers.
                         UNITS:      N/A
                         TYPE:       CRTM_Atmosphere_type
                         DIMENSION:  Scalar
                         ATTRIBUTES: INTENT(IN OUT)
 
  OUTPUT ARGUMENTS:
        Atm_In_AD:       Adjoint atmosphere structure at the original, user
                         specified layering.
                         UNITS:      N/A
                         TYPE:       CRTM_Atmosphere_type
                         DIMENSION:  Scalar
                         ATTRIBUTES: INTENT(IN OUT)
 
  OPTIONAL INPUT ARGUMENTS:
        Message_Log:     Character string specifying a filename in which any
                         messages will be logged. If not specified, or if an
                         error occurs opening the log file, the default action
                         is to output messages to standard output.
                         UNITS:      N/A
                         TYPE:       CHARACTER(*)
                         DIMENSION:  Scalar
                         ATTRIBUTES: INTENT(IN), OPTIONAL
 
  FUNCTION RESULT:
        Error_Status:    The return value is an integer defining the error status.
                         The error codes are defined in the Message_Handler module.
                         If == SUCCESS the operation was successful
                            == FAILURE an error occurred
                         UNITS:      N/A
                         TYPE:       INTEGER
                         DIMENSION:  Scalar
 
  SIDE EFFECTS:
        The input adjoint atmosphere structure, Atm_Out_AD, is zeroed out
        prior to returning to the calling procedure.
 
  COMMENTS:
        Note the INTENT on the output Atm_In_AD argument is IN OUT rather than
        just OUT. This is necessary because the argument may be defined upon
        input. To prevent memory leaks, the IN OUT INTENT is a must.
 
  \end{alltt}
