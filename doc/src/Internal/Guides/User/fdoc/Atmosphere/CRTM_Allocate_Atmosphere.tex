\subsection{\texttt{CRTM\_Allocate\_Atmosphere} interface}
  \label{sec:CRTM_Allocate_Atmosphere_interface}
  \begin{alltt}
 
  NAME:
        CRTM_Allocate_Atmosphere
  
  PURPOSE:
        Function to allocate CRTM Atmosphere data structures.
 
  CALLING SEQUENCE:
        Error_Status = CRTM_Allocate_Atmosphere( n_Layers               , &
                                                 n_Absorbers            , &
                                                 n_Clouds               , &
                                                 n_Aerosols             , &
                                                 Atmosphere             , &
                                                 Message_Log=Message_Log  )
 
  INPUT ARGUMENTS:
        n_Layers:     Number of layers dimension.
                      Must be > 0.
                      UNITS:      N/A
                      TYPE:       INTEGER
                      DIMENSION:  Scalar OR Rank-1
                                  See output Atmosphere dimensionality chart
                      ATTRIBUTES: INTENT(IN)
 
        n_Absorbers:  Number of absorbers dimension. This will be the same for
                      all elements if the Atmosphere argument is an array.
                      Must be > 0.
                      UNITS:      N/A
                      TYPE:       INTEGER
                      DIMENSION:  Scalar
                      ATTRIBUTES: INTENT(IN)
 
        n_Clouds:     Number of clouds dimension of Atmosphere data.
                      ** Note: Can be = 0 (i.e. clear sky). **
                      UNITS:      N/A
                      TYPE:       INTEGER
                      DIMENSION:  Scalar OR Rank-1
                                  See output Atmosphere dimensionality chart
                      ATTRIBUTES: INTENT(IN)
 
        n_Aerosols:   Number of aerosol types dimension of Atmosphere data.
                      ** Note: Can be = 0 (i.e. no aerosols). **
                      UNITS:      N/A
                      TYPE:       INTEGER
                      DIMENSION:  Scalar OR Rank-1
                                  See output Atmosphere dimensionality chart
                      ATTRIBUTES: INTENT(IN)
 
  OPTIONAL INPUT ARGUMENTS:
        Message_Log:  Character string specifying a filename in which any
                      messages will be logged. If not specified, or if an
                      error occurs opening the log file, the default action
                      is to output messages to standard output.
                      UNITS:      N/A
                      TYPE:       CHARACTER(*)
                      DIMENSION:  Scalar
                      ATTRIBUTES: INTENT(IN), OPTIONAL
 
  OUTPUT ARGUMENTS:
        Atmosphere:   Atmosphere structure with allocated components. The
                      following table shows the allowable dimension combinations
                      for the calling routine, where M == number of profiles:
 
                         Input       Input       Input      Input        Output
                        n_Layers   n_Absorbers  n_Clouds  n_Aerosols    Atmosphere
                        dimension   dimension   dimension  dimension    dimension
                      --------------------------------------------------------------
                         scalar      scalar      scalar     scalar       scalar
                         scalar      scalar      scalar     scalar         M
                         scalar      scalar      scalar       M            M
                         scalar      scalar        M        scalar         M
                         scalar      scalar        M          M            M
                           M         scalar      scalar     scalar         M
                           M         scalar      scalar       M            M
                           M         scalar        M        scalar         M
                           M         scalar        M          M            M
 
                      Note the number of absorbers cannot vary with the profile.
 
                      These multiple interfaces are supplied purely for ease of
                      use depending on what data is available.
                      
                      UNITS:      N/A
                      TYPE:       CRTM_Atmosphere_type
                      DIMENSION:  Scalar or Rank-1
                                  See chart above.
                      ATTRIBUTES: INTENT(IN OUT)
 
 
  FUNCTION RESULT:
        Error_Status: The return value is an integer defining the error status.
                      The error codes are defined in the Message_Handler module.
                      If == SUCCESS the structure re-initialisation was successful
                         == FAILURE - an error occurred, or
                                    - the structure internal allocation counter
                                      is not equal to one (1) upon exiting this
                                      function. This value is incremented and
                                      decremented for every structure allocation
                                      and deallocation respectively.
                      UNITS:      N/A
                      TYPE:       INTEGER
                      DIMENSION:  Scalar
 
  COMMENTS:
        Note the INTENT on the output Atmosphere argument is IN OUT rather than
        just OUT. This is necessary because the argument may be defined upon
        input. To prevent memory leaks, the IN OUT INTENT is a must.
 
  \end{alltt}
