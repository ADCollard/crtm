% The generic preamble
\input{preamble}

% Include files
\includeonly{Imager_SRF_Data_Plots.app,Sounder_SRF_Data_Plots.app,Imager_Tfit_Data_Plots.app,Sounder_Tfit_Data_Plots.app}

% Subversion keywords
\SVN $Date$
\SVN $Revision$

% Title info
\title{INSAT-3D Imager and Sounder Spectral Response Function Processing}
\author{Paul van Delst\email{paul.vandelst@noaa.gov}\\NCEP/EMC/IMSG}
\date{\SVNDate ; rev\SVNRevision}
\docnumber{3}
\docseries{CRTM}


%-------------------------------------------------------------------------------
%                            Ze document begins...
%-------------------------------------------------------------------------------
\begin{document}
\maketitle

%\draftwatermark

% The front matter
%=================
\thispagestyle{empty}
\vspace*{10cm}
\begin{center}
  {\sffamily\Large\bfseries Change History}
  \begin{table}[htp]
    \centering
    \begin{tabular}{|p{2cm}|p{3cm}|p{8cm}|}
      \hline
      \sffamily\textbf{Date} & \sffamily\textbf{Author} & \sffamily\textbf{Change}\\
      \hline\hline
      2013-11-21 & Paul van Delst & Initial draft.\\
      \hline
      2014-07-07 & Paul van Delst & Modified for updated SRF data.\\
      \hline
    \end{tabular}
  \end{table}
\end{center}
\clearpage
\pagestyle{fancy}
\fancyhead[LE,RO]{\sffamily \rightmark}
\fancyhead[LO,RE]{\sffamily \leftmark}
\pagenumbering{arabic}
\setcounter{page}{1}


% The main matter
%================

\section{Introduction}
%=====================
This document describes the pre-processing applied to the INSAT-3D Imager and Sounder instruments updated spectral response functions (SRFs), obtained from \cite{INSAT3D_SRF_Data2} in June 2014, to prepare for use in the CRTM processing chain. The SRFs are used to generate channel central frequencies, as well as in the convolution of monochromatic quantities such as Planck radiances or line-by-line (LBL) model generated transmittances to produce such things as polychromatic correction coefficients and instrument resolution transmittances. The latter, for a diverse set of atmospheric profiles, are then regressed against a set of predictors to produce the fast transmittance model coefficients used by the CRTM.

Comparisons are also made with the original SRF dataset \citep{INSAT3D_SRF_Data} obtained in October 2013.


\subsection{Computation of the channel central frequency}
%--------------------------------------------------------
The computed imager and sounder channel central frequencies, $\nu_0$, are the first moments of the defined SRF, $\phi(\nu)$,
\begin{equation}
  \nu_0 = \frac{\displaystyle\int{\nu\:\phi(\nu)\ud \nu}}{\displaystyle\int{\phi(\nu)\ud \nu}}
\end{equation}


\subsection{Computation of polychromatic correction coefficients}
%----------------------------------------------------------------
In the CRTM, the conversion of \emph{channel resolution} radiances to brightness temperatures has to take the channel bandwidth into account. For any channel, the regression relation to be solved is

\begin{equation}
  a_0 + a_1T + \ldots = \frac{\displaystyle k_1}{\displaystyle \ln\left[\frac{k_2}{R(T)}+1\right]} = Y(T)
  \label{eqn:polycorr_regression}
\end{equation}
where
\begin{equation*}
  \begin{array}{r@{\;=\;}l}
         T &\mbox{brightness temperature} \\
        a_j&\mbox{regression coefficients} \\
    k_1,k_2&\mbox{Planck coefficients} \\
       R(T)&\mbox{channel radiance} \\
       Y(T)&\mbox{``effective'' brightness temperature, or $T_{eff}$}
  \end{array}
\end{equation*}
and the channel radiances used to determine the effective temperatures, $Y(T)$, are computed the usual way
\begin{equation}
  R(T) = \frac{\displaystyle\int{B(T,\nu)\:\phi(\nu)\ud \nu}}{\displaystyle\int{\phi(\nu)\ud \nu}}
\end{equation}
The quantity minimised to obtain the $a_j$ coefficients is
\begin{equation}
  \left[ \sum_{j=0}^{M}a_j T_{i} - Y(T_{i}) \right]^2 \quad\mbox{for}\quad T_i = 150K, \ldots, 340K \;\mbox{ in 5K steps.}
\end{equation}
Currently the number of coefficients is fixed at two (i.e. $M=1$).



\newpage
\section{Summary}
%================

The following tables list the computed central frequencies and polychromatic correction coefficients for the imager and sounder instruments, as well the differences with the same quantities obtained from the original set of SRFs.

\subsection{Imager}
%------------------

Plots of the Imager SRF data, and their differences, are shown in appendix \ref{app.imgr_srf_data_plots}. The temperature fit residuals for each channel, and their differences from those of the original SRF dataset, are shown in appendix \ref{app.imgr_tfit_data_plots}.

\begin{table}[htp]
  \centering
  \begin{tabular}{C{1.5cm} R{1.5cm}@{.}L{1.5cm} *{2}{R{1cm}@{.}L{2cm}}}
    \hline
    \sffamily{Imager} & \multicolumn{2}{c}{$\nu_0$} & \multicolumn{2}{c}{$a_0$ \textsf{(offset)}} & \multicolumn{2}{c}{$a_1$ \textsf{(slope)}} \\
    \sffamily{Channel} & \multicolumn{2}{c}{\sffamily{(\invcm)}} & \multicolumn{2}{c}{\sffamily{(K)}} & \multicolumn{2}{c}{\sffamily{(K/K)}}  \\
    \hline\hline
    3  & 2548&42014 & 0&39830363 & 0&99942687 \\
    4  & 1454&40973 & 0&62372841 & 0&99852040 \\
    5  &  925&09803 & 0&38137920 & 0&99868532 \\
    6  &  837&38593 & 0&26594109 & 0&99899992 \\
    \hline
  \end{tabular}
  \caption{The computed INSAT-3D Imager channel central frequencies and polychromatic correction coefficients.}
  \label{tab:imgr_insat3d_results}
\end{table}


\begin{table}[htp]
  \centering
  \begin{tabular}{C{1.5cm} *{3}{R{1cm}@{.}L{2cm}}}
    \hline
    \sffamily{Imager} & \multicolumn{2}{c}{$\Delta \nu_0$} & \multicolumn{2}{c}{$\Delta a_0$ \textsf{(offset)}} & \multicolumn{2}{c}{$\Delta a_1$ \textsf{(slope)}} \\
    \sffamily{Channel} & \multicolumn{2}{c}{\sffamily{(\invcm)}} & \multicolumn{2}{c}{\sffamily{(K)}} & \multicolumn{2}{c}{\sffamily{(K/K)}}  \\
    \hline\hline
    3  &  1&222473e-01 &  5&340637e-03 & -7&614884e-06 \\
    4  & -2&330886e-01 & -5&954575e-03 &  1&229867e-05 \\
    5  &  2&532271e-01 &  9&930551e-04 & -3&163284e-06 \\
    6  &  5&192023e-01 &  1&575004e-03 & -5&534034e-06 \\
    \hline
  \end{tabular}
  \caption{The difference between the computed INSAT-3D Imager channel central frequencies and polychromatic correction coefficients for the updated SRFs.}
  \label{tab:imgr_insat3d_results_difference}
\end{table}



\subsection{Sounder}
%-------------------

Plots of the Sounder SRF data, and their differences, are shown in appendix \ref{app.sndr_srf_data_plots}. The temperature fit residuals for each channel, and their differences from those of the original SRF dataset, are shown in appendix \ref{app.sndr_tfit_data_plots}.

It should be noted here that there are significant SRF differences for some of the sounder channels, in particular the shortware channels 13-18. For these channels there is a sgnificant shift of the SRFs to lower frequencies. This is reflected in the central frequency differences shown in table \ref{tab:sndr_insat3d_results_difference}, with $\Delta \nu_0$ values for channels 13-18 ranging from 7-15\invcm. See figures \ref{fig:sndr_ch13} to \ref{fig:sndr_ch18} for plots of those particular SRFs.

\begin{table}[htp]
  \centering
  \begin{tabular}{C{1.5cm} R{1.5cm}@{.}L{1.5cm} *{2}{R{1cm}@{.}L{2cm}}}
    \hline
    \sffamily{Sounder} & \multicolumn{2}{c}{$\nu_0$} & \multicolumn{2}{c}{$a_0$ \textsf{(offset)}} & \multicolumn{2}{c}{$a_1$ \textsf{(slope)}} \\
    \sffamily{Channel} & \multicolumn{2}{c}{\sffamily{(\invcm)}} & \multicolumn{2}{c}{\sffamily{(K)}} & \multicolumn{2}{c}{\sffamily{(K/K)}}  \\
    \hline\hline
    1 &  681&62206 & 0&03046981 & 0&99986043 \\
    2 &  698&62139 & 0&01879741 & 0&99991614 \\
    3 &  712&58032 & 0&02289618 & 0&99989992 \\
    4 &  733&35257 & 0&03227880 & 0&99986293 \\
    5 &  750&09886 & 0&03643214 & 0&99984866 \\
    6 &  794&15150 & 0&09316524 & 0&99963313 \\
    7 &  834&32264 & 0&19522736 & 0&99926418 \\
    8 &  909&58337 & 0&17639610 & 0&99938313 \\
    9 & 1031&98619 & 0&06386464 & 0&99979895 \\
   10 & 1346&10910 & 0&18572004 & 0&99952975 \\
   11 & 1420&56284 & 0&39893243 & 0&99903751 \\
   12 & 1533&28319 & 0&23487739 & 0&99946755 \\
   13 & 2167&56741 & 0&03284663 & 0&99994502 \\
   14 & 2202&05890 & 0&03255260 & 0&99994615 \\
   15 & 2232&00124 & 0&03692231 & 0&99993955 \\
   16 & 2407&95850 & 0&06765204 & 0&99989696 \\
   17 & 2495&40576 & 0&07411556 & 0&99989035 \\
   18 & 2642&07962 & 0&29912655 & 0&99958143 \\
    \hline
  \end{tabular}
  \caption{The computed INSAT-3D Sounder channel central frequencies and polychromatic correction coefficients.}
  \label{tab:sndr_insat3d_results}
\end{table}

\begin{table}[htp]
  \centering
  \begin{tabular}{C{1.5cm} *{3}{R{1cm}@{.}L{2cm}}}
    \hline
    \sffamily{Sounder} & \multicolumn{2}{c}{$\Delta \nu_0$} & \multicolumn{2}{c}{$\Delta a_0$ \textsf{(offset)}} & \multicolumn{2}{c}{$\Delta a_1$ \textsf{(slope)}} \\
    \sffamily{Channel} & \multicolumn{2}{c}{\sffamily{(\invcm)}} & \multicolumn{2}{c}{\sffamily{(K)}} & \multicolumn{2}{c}{\sffamily{(K/K)}}  \\
    \hline\hline
    1 & -2&384271e-02 & -3&624546e-03 &  1&668416e-05 \\
    2 &  8&865027e-02 & -1&526845e-02 &  6&818310e-05 \\
    3 &  4&900753e-01 & -4&772684e-03 &  2&092925e-05 \\
    4 &  3&295078e-01 & -8&518261e-03 &  3&620886e-05 \\
    5 & -6&201422e-01 & -5&343381e-03 &  2&205690e-05 \\
    6 &  1&554839e+00 & -6&541811e-03 &  2&635550e-05 \\
    7 &  7&305848e-02 & -6&097686e-03 &  2&316287e-05 \\
    8 &  3&525065e+00 &  3&889811e-03 & -1&204881e-05 \\
    9 &  2&663744e+00 &  7&985571e-03 & -2&478078e-05 \\
   10 &  1&640695e+00 & -4&912065e-02 &  1&249970e-04 \\
   11 & -1&523594e+00 & -1&921560e-01 &  4&823958e-04 \\
   12 &  2&733226e+00 & -1&121861e-01 &  2&577023e-04 \\
   13 & -1&597081e+01 &  9&645771e-04 & -1&859146e-06 \\
   14 & -7&024429e+00 &  7&376784e-04 & -1&467514e-06 \\
   15 & -9&069491e+00 & -1&235584e-03 &  1&723795e-06 \\
   16 & -1&180761e+01 &  2&795438e-03 & -4&620730e-06 \\
   17 & -1&464507e+01 &  5&941099e-04 & -1&262977e-06 \\
   18 & -1&554782e+01 &  2&980200e-02 & -4&402094e-05 \\
    \hline
  \end{tabular}
  \caption{The difference between the computed INSAT-3D Sounder channel central frequencies and polychromatic correction coefficients for the updated SRFs.}
  \label{tab:sndr_insat3d_results_difference}
\end{table}


\newpage
\section{Truncation of SRF data}
%===============================
\label{sec:data_truncation}

The SRFs were reported on the same frequency grid for all channels in an instrument, with out-of-band responses set to zero. To minimise the number of frequencies for which LBL calculations would be done, the SRF data were truncated to eliminate the zero-valued out-of-band elements. The truncation points were selected automatically by determining the first non-zero point either side of the SRF, and then extending back 20 data points.

\subsection{Imager}
%------------------
The truncation frequencies for the imager instrument are shown in table \ref{tab:imgr_insat3d_truncation}. The ``character'' of the imager SRFs at low response levels near the truncations points are shown in figure \ref{fig:imgr_ch3-6_trunc}


\begin{table}[htp]
  \centering
  \begin{tabular}{c *{2}{c r@{.}l}}
    \hline
    \sffamily{Sounder} & & \multicolumn{2}{c}{$\nu_1$} & & \multicolumn{2}{c}{$\nu_2$}  \\
    \sffamily{Channel} & & \multicolumn{2}{c}{\sffamily{(\invcm)}} & & \multicolumn{2}{c}{\sffamily{(\invcm)}} \\
    \hline\hline
    3 & & 2449&10 & & 2647&40  \\
    4 & & 1338&60 & & 1564&40  \\
    5 & &  869&20 & &  986&20  \\
    6 & &  788&00 & &  882&20  \\
    \hline
  \end{tabular}
  \caption{The frequencies at which the INSAT-3D Imager channel SRFs were truncated prior to processing.}
  \label{tab:imgr_insat3d_truncation}
\end{table}

\begin{figure}[H]
  \centering
  \begin{tabular}{c c}
    \includegraphics[scale=0.35]{graphics/imgr/trunc/imgr_insat3d-3.trunc.eps} &
    \includegraphics[scale=0.35]{graphics/imgr/trunc/imgr_insat3d-4.trunc.eps} \\
    \includegraphics[scale=0.35]{graphics/imgr/trunc/imgr_insat3d-5.trunc.eps} &
    \includegraphics[scale=0.35]{graphics/imgr/trunc/imgr_insat3d-6.trunc.eps}
  \end{tabular}
  \caption{INSAT-3D Imager channels 3-6 SRFs at low response levels near the truncation frequencies.}
  \label{fig:imgr_ch3-6_trunc}
\end{figure}


\subsection{Sounder}
%-------------------
The truncation frequencies for the sounder instrument are shown in table \ref{tab:sndr_insat3d_truncation}. The ``character'' of the sounder SRFs, for a selection of channels, at low response levels near the truncations points are shown in figure \ref{fig:sndr_selection_trunc}. 



\begin{table}[htp]
  \centering
  \begin{tabular}{c *{2}{c r@{.}l}}
    \hline
    \sffamily{Sounder} & & \multicolumn{2}{c}{$\nu_1$} & & \multicolumn{2}{c}{$\nu_2$}  \\
    \sffamily{Channel} & & \multicolumn{2}{c}{\sffamily{(\invcm)}} & & \multicolumn{2}{c}{\sffamily{(\invcm)}} \\
    \hline\hline
     1 & &   660&90 & &  704&70 \\
     2 & &   683&30 & &  715&20 \\
     3 & &   695&50 & &  730&00 \\
     4 & &   712&70 & &  757&30 \\
     5 & &   727&50 & &  776&60 \\
     6 & &   758&30 & &  831&60 \\
     7 & &   781&50 & &  884&30 \\
     8 & &   861&20 & &  962&80 \\
     9 & &   996&90 & & 1068&90 \\
    10 & &  1271&50 & & 1409&20 \\
    11 & &  1319&40 & & 1524&90 \\
    12 & &  1458&30 & & 1605&50 \\
    13 & &  2135&20 & & 2208&10 \\
    14 & &  2168&50 & & 2237&70 \\
    15 & &  2197&20 & & 2268&10 \\
    16 & &  2363&60 & & 2457&40 \\
    17 & &  2447&00 & & 2547&40 \\
    18 & &  2552&00 & & 2736&80 \\
    \hline
  \end{tabular}
  \caption{The frequencies at which the INSAT-3D Sounder channel SRFs were truncated prior to processing.}
  \label{tab:sndr_insat3d_truncation}
\end{table}

\begin{figure}[H]
  \centering
  \begin{tabular}{c c}
    \includegraphics[scale=0.35]{graphics/sndr/trunc/sndr_insat3d-1.trunc.eps} &
    \includegraphics[scale=0.35]{graphics/sndr/trunc/sndr_insat3d-6.trunc.eps} \\
    \includegraphics[scale=0.35]{graphics/sndr/trunc/sndr_insat3d-8.trunc.eps} &
    \includegraphics[scale=0.35]{graphics/sndr/trunc/sndr_insat3d-10.trunc.eps}
  \end{tabular}
  \caption{A selection of INSAT-3D Sounder channel SRFs at low response levels near the trunction frequencies.}
  \label{fig:sndr_selection_trunc}
\end{figure}


\newpage
\section{Impact of updated SRFs on convolved radiances}
%======================================================
\label{sec:updated_impact}
To determine the impact of the updated SRFs on the convolved channel radiancesd, both sets of data (original and updated SRFs) were convolved with LBL-model generated radiances.

LBLRTM \citep{Clough_2005} v12.2 was used with the ECMWF83 atmospheric profile dataset to generate radiance spectra. The radiance spectra were convovled with the SRFs to yield channel resolution radiances which were then converted to brightness temperatures for each SRF set. The statistics of the brightness temperature differences for the Imager instrument are shown in figure \ref{fig:imgr_dTb_stats}, and in \ref{fig:sndr_dTb_stats} for the Sounder. For the Imager, the largest individual differences are the hundredths of a Kelvin level. For the Sounder, however, the large differences between the original and updated SRF datasets for the shortwave channels, 13-18 (see figures \ref{fig:sndr_ch13}-\ref{fig:sndr_ch18}), are reflected in the 4-8K brightness temperatures differences for some of those channels, 13-16. Channels 17 and 18 are less affected by the SRF shifts as they are window channels.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.8]{graphics/imgr/imgr_insat3d.dTb_stats.eps}
  \caption{Statistics of the brightness temperature differences between the original and updated INSAT-3D Imager SRFs. The calculations used LBLRTM v12.2 and the ECMWF83 profile dataset with a surface emissivity of 0.95.}
  \label{fig:imgr_dTb_stats}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.8]{graphics/sndr/sndr_insat3d.dTb_stats.eps}
  \caption{Statistics of the brightness temperature differences between the original and updated INSAT-3D Sounder SRFs. The calculations used LBLRTM v12.2 and the ECMWF83 profile dataset with a surface emissivity of 0.95.}
  \label{fig:sndr_dTb_stats}
\end{figure}

% The references section
%=======================
\clearpage
\bibliographystyle{plainnat}
\bibliography{bibliography}


% The appendices section
%=======================
\begin{appendix}
  \include{Imager_SRF_Data_Plots.app}
  \include{Imager_Tfit_Data_Plots.app}
  \include{Sounder_SRF_Data_Plots.app}
  \include{Sounder_Tfit_Data_Plots.app}
\end{appendix}

\end{document}

