\section{Impact on computational speed due to polynomial calculations}
%=====================================================================
\label{sec:Poly_Routine_Speed.appendix}
Both the Ellison \cite{Ellison_etal_2003} and Guillou \cite{Guillou_etal_1998} emissivity models use polynomial fits to data to repesent various components of the complex ocean surface permittivity. Forward, tangent-linear, and adjoint polynomial computation routines were written to simplify their evaluation.

The permittivity codes were profiled with the polynomial calculations performed inline, and using the polynomial routines with the profiler outputs. The results are shown in figures \ref{fig:ellison_nopoly_profile} and \ref{fig:ellison_poly_profile} for the Ellison code, and figures \ref{fig:guillou_nopoly_profile} and \ref{fig:guillou_poly_profile} for the Guillou code. On average, the inline polynomial evaluation results in the test code running approximately two (Ellison) to three (Guillou) times faster than if evaluation routines were used. The larger impact for the Guillou code is likely due to there being more polynomials to evaluate, many with six coefficients.

Note that the 2-3$\times$ factor from the profiling tests does not necessarily translate into wall-clock time.

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
Each sample counts as 0.01 seconds.
  %   cumulative  self                     
 time   seconds  seconds    calls  name    
 31.43    2.36    2.36          1  MAIN__
 22.17    4.03    1.67   16669800  unit_test_MOD_fp_equal_within_scalar
 21.97    5.68    1.65    9724050  ocean_permittivity_MOD_ellison_ocean_permittivity
 19.04    7.11    1.43    9261000  ocean_permittivity_MOD_ellison_ocean_permittivity_tl
  3.46    7.37    0.26    1852200  ocean_permittivity_MOD_ellison_ocean_permittivity_ad
  0.87    7.43    0.07   16669800  unit_test_MOD_last_test_failed
  0.73    7.49    0.06   16669800  unit_test_MOD_test_passed
  0.33    7.51    0.03             unit_test_MOD_fp_equal_within_rank1
      \end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{Profile results for Ellison permittivity tests with polynomial evaluation performed inline.}
  \label{fig:ellison_nopoly_profile}
\end{figure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
  \begin{ttfamily}
    \begin{verbatim}
Each sample counts as 0.01 seconds.
  %   cumulative  self                      
 time   seconds  seconds    calls  name    
 28.67    4.09    4.09   38896200  ocean_permittivity_MOD_poly
 18.28    6.69    2.61   37044000  ocean_permittivity_MOD_poly_tl
 14.11    8.70    2.01          1  MAIN__
 12.32   10.46    1.76    9724050  ocean_permittivity_MOD_ellison_ocean_permittivity
 10.77   11.99    1.54   16669800  unit_test_MOD_fp_equal_within_scalar
  8.00   13.13    1.14    9261000  ocean_permittivity_MOD_ellison_ocean_permittivity_tl
  3.47   13.63    0.50    7408800  ocean_permittivity_MOD_poly_ad
  2.84   14.03    0.41    1852200  ocean_permittivity_MOD_ellison_ocean_permittivity_ad
  0.84   14.15    0.12   16669800  unit_test_MOD_test_passed
  0.56   14.23    0.08   16669800  unit_test_MOD_last_test_failed
  0.07   14.24    0.01             unit_test_MOD_test_failed
  0.04   14.25    0.01          1  timing_utility_MOD_begin_timing
    \end{verbatim}
  \end{ttfamily}
  \end{minipage}
  }
  \caption{Profile results for Ellison permittivity tests using polynomial evaluation subroutines}
  \label{fig:ellison_poly_profile}
\end{figure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
    \begin{ttfamily}
      \begin{verbatim}
Each sample counts as 0.01 seconds.
  %   cumulative   self                      
 time   seconds   seconds    calls   name    
 25.66    2.15     2.15          1   MAIN__
 24.94    4.24     2.09    9261000   ocean_permittivity_MOD_guillou_ocean_permittivity_tl
 24.46    6.29     2.05    9724050   ocean_permittivity_MOD_guillou_ocean_permittivity
 16.77    7.70     1.41   16669800   unit_test_MOD_fp_equal_within_scalar
  5.01    8.12     0.42    1852200   ocean_permittivity_MOD_guillou_ocean_permittivity_ad
  2.09    8.29     0.18   16669800   unit_test_MOD_test_passed
  0.90    8.37     0.08   14817600   unit_test_MOD_last_test_failed
  0.12    8.38     0.01              unit_test_MOD_test_failed
      \end{verbatim}
    \end{ttfamily}
  \end{minipage}
  }
  \caption{Profile results for Guillou permittivity tests with polynomial evaluation performed inline.}
  \label{fig:guillou_nopoly_profile}
\end{figure}

\begin{figure}[htp]
  \centering
  \doublebox{
  \begin{minipage}[b]{6.5in}
  \begin{ttfamily}
    \begin{verbatim}
Each sample counts as 0.01 seconds.
  %   cumulative   self                      
 time   seconds   seconds    calls   name    
 38.64    9.85     9.85   68068350   ocean_permittivity_MOD_poly
 21.76   15.39     5.55   64827000   ocean_permittivity_MOD_poly_tl
  9.50   17.81     2.42    9724051   ocean_permittivity_MOD_guillou_ocean_permittivity
  9.34   20.19     2.38              MAIN__
  7.10   22.00     1.81   16669800   unit_test_MOD_fp_equal_within_scalar
  5.89   23.50     1.50    9261000   ocean_permittivity_MOD_guillou_ocean_permittivity_tl
  5.30   24.85     1.35   12965400   ocean_permittivity_MOD_poly_ad
  1.37   25.20     0.35    1852200   ocean_permittivity_MOD_guillou_ocean_permittivity_ad
  0.47   25.32     0.12   16669800   unit_test_MOD_test_passed
  0.31   25.40     0.08   14817600   unit_test_MOD_last_test_failed
  0.12   25.43     0.03              unit_test_MOD_fp_equal_within_rank1
  0.12   25.46     0.03              unit_test_MOD_test_failed
  0.08   25.48     0.02              ocean_permittivity_MOD_ellison_ocean_permittivity_ad
    \end{verbatim}
  \end{ttfamily}
  \end{minipage}
  }
  \caption{Profile results for Guillou permittivity tests using polynomial evaluation subroutines}
  \label{fig:guillou_poly_profile}
\end{figure}

