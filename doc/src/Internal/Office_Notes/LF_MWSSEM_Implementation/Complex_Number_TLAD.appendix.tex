\section{Testing the tangent-linear and adjoint of complex numbered expressions}
%===============================================================================

Given a complex number, $z$, such that,
\begin{equation}
  z = a + ib
  \label{eqn:z_defn}
\end{equation}
where $i = \sqrt{-1}$, let a real number, $r$, be the square of the absolute value of $z$,
\begin{equation}
  r = |z|^2
  \label{eqn:r_z}
\end{equation}
This can be rewritten as,
\begin{equation}
  r = z.\overline{z}
  \label{eqn:r_zconjz}
\end{equation}
where $\overline{z}$ is the complex conjugate,
\begin{equation}
  \overline{z} = a - ib
  \label{eqn:conjz_defn}
\end{equation}
The tangent-linear form of equation \ref{eqn:r_zconjz} is written as,
\begin{equation}
  \delta r = 2z.\delta\overline{z}
  \label{eqn:r_zconjz_tl}
\end{equation}
The adjoint form of equation \ref{eqn:r_zconjz_tl} is,
\begin{equation}
  \delta^{*}\overline{z} = 2z.\delta^{*}r
  \label{eqn:r_zconjz_ad}
\end{equation}
We define a simple test where, when the tangent-linear output of equation \ref{eqn:r_zconjz_tl} is used as the adjoint input of equation \ref{eqn:r_zconjz_ad}, then
\begin{equation}
  \delta r^{T}\delta r = \delta z^T \delta^{*}\overline{z} 
  \label{eqn:r_z_tlad_test}
\end{equation}
Substituting the results of equations \ref{eqn:r_zconjz_tl} and \ref{eqn:r_zconjz_ad} into equation \ref{eqn:r_z_tlad_test} we get,
\begin{eqnarray}
  \left(2z.\delta\overline{z}\right)^{2} & = & \delta\overline{z}.2z.\delta r\nonumber \\
                                         & = & \delta\overline{z}.2z.2z.\delta\overline{z}\nonumber \\
                                         & = & \left(2z.\delta\overline{z}\right)^{2}
  \label{eqn:r_z_tlad_test_subst}
\end{eqnarray}
where the transpose of a complex number is also its conjugate. The latter follows if one represents a complex number as an antisymmetric matrix,
\begin{equation}
  z \equiv \left[
             \begin{array}{c c}
               a & -b \\
               b & a
             \end{array}
           \right]
\end{equation}
where it is clear that $z^T = \overline{z}$.
