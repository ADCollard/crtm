\section{CloudScatter Adjoint Model Profile Results}
%===================================================
As with the other models, the adjoint test results are shown separately for the microwave and infrared cloud optical property LUT interpolation.

Here again we see significant differences in the routine timings between the Baseline and Modified test runs. Because the forward model interpolation parameters are reused rather than recalculated in the Modified runs, the time required for the \texttt{find\_random\_index} and \texttt{lpoly} routines do not contribute. Looking at the ``self'' value for the main routines, we see the Modified times are about 3-4x faster. A word of caution though: the test duration itself is quite short so the speedup factor should be regarded as a very rough guide. The main point is that the modifications do not make the code any slower.

\subsection{Linux test}
%----------------------

\begin{table}[ht]
  \centering
  \begin{tabular}{p{0.25cm} p{3.55cm} *{2}{r@{.}l} c *{2}{r@{.}l}}
    \hline
                    &                    & \multicolumn{4}{c}{\textbf{Baseline}} & \hspace{1.0em} & \multicolumn{4}{c}{\textbf{Modified}} \\
    \multicolumn{2}{c}{\textbf{Routine}} & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} & & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} \\
    \hline\hline
    \multicolumn{2}{l}{\texttt{get\_cloud\_opt\_mw\_ad}} & 36&90 & 187&22   & &   10&22 & 187&56 \vspace{0.5em}\\
    &\texttt{interp\_3d\_ad}                             &  8&70 &  98&79   & &    8&79 & 120&22 \\
    &\texttt{interp\_2d\_ad}                             &  7&82 &  23&92   & &    8&81 &  29&42 \\
    &\texttt{find\_random\_index}                        & 16&61 &   0&00   & &    \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    &\texttt{lpoly\_ad}                                  &  2&72 &  13&54   & &    2&87 &  15&18 \\
    &\texttt{lpoly}                                      &  2&25 &  10&33   & &    \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    \hline
  \end{tabular}
  \caption{gfortran CloudScatter Adjoint model profile results for the \texttt{Get\_Cloud\_Opt\_MW\_AD} subroutine. All times in seconds.}
  \label{tab:ad_cs_test_get_cloud_opt_mw_gfortran}
\end{table}


\begin{table}[ht]
  \centering
  \begin{tabular}{p{0.25cm} p{3.55cm} *{2}{r@{.}l} c *{2}{r@{.}l}}
    \hline
                    &                    & \multicolumn{4}{c}{\textbf{Baseline}} & \hspace{1.0em} & \multicolumn{4}{c}{\textbf{Modified}} \\
    \multicolumn{2}{c}{\textbf{Routine}} & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} & & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} \\
    \hline\hline
    \multicolumn{2}{l}{\texttt{get\_cloud\_opt\_ir\_ad}} & 16&04 & 60&53   & &    4&31 & 59&33 \vspace{0.5em}\\
    &\texttt{interp\_2d\_ad}                             &  9&74 & 29&82   & &   10&96 & 36&60 \\
    &\texttt{lpoly\_ad}                                  &  1&66 &  8&25   & &    1&75 &  9&24 \\
    &\texttt{find\_random\_index}                        &  5&79 &  0&00   & &                 \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    &\texttt{lpoly}                                      &  0&79 &  3&60   & &                 \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    \hline
  \end{tabular}
  \caption{gfortran CloudScatter Adjoint model profile results for the \texttt{Get\_Cloud\_Opt\_IR\_AD} subroutine. All times in seconds.}
  \label{tab:ad_cs_test_get_cloud_opt_ir_gfortran}
\end{table}

  
\subsection{IBM test}
%--------------------

\begin{table}[ht]
  \centering
  \begin{tabular}{p{0.25cm} p{3.55cm} *{2}{r@{.}l} c *{2}{r@{.}l}}
    \hline
                    &                    & \multicolumn{4}{c}{\textbf{Baseline}} & \hspace{1.0em} & \multicolumn{4}{c}{\textbf{Modified}} \\
    \multicolumn{2}{c}{\textbf{Routine}} & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} & & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} \\
    \hline\hline
    \multicolumn{2}{l}{\texttt{get\_cloud\_opt\_mw\_ad}} & 509&93 & 1842&51   & &   101&19 & 1708&72 \vspace{0.5em}\\
    &\texttt{interp\_3d\_ad}                             & 126&71 & 1091&69   & &   119&90 & 1100&07 \\
    &\texttt{interp\_2d\_ad}                             & 112&66 &  239&15   & &   116&78 &  239&04 \\
    &\texttt{lpoly\_ad}                                  &  13&81 &  104&49   & &    13&17 &  106&08 \\
    &\texttt{lpoly}                                      &  19&90 &   69&37   & &   \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    &\texttt{find\_random\_index}                        &  51&25 &    0&00   & &   \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    \hline
  \end{tabular}
  \caption{IBM CloudScatter Adjoint model profile results for the \texttt{Get\_Cloud\_Opt\_MW\_AD} subroutine. All times in seconds.}
  \label{tab:ad_cs_test_get_cloud_opt_mw_ibm}
\end{table}

               
\begin{table}[ht]
  \centering
  \begin{tabular}{p{0.25cm} p{3.55cm} *{2}{r@{.}l} c *{2}{r@{.}l}}
    \hline
                    &                    & \multicolumn{4}{c}{\textbf{Baseline}} & \hspace{1.0em} & \multicolumn{4}{c}{\textbf{Modified}} \\
    \multicolumn{2}{c}{\textbf{Routine}} & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} & & \multicolumn{2}{c}{\textbf{self}} & \multicolumn{2}{c}{\textbf{called}} \\
    \hline\hline
    \multicolumn{2}{l}{\texttt{get\_cloud\_opt\_ir\_ad}} & 137&81 & 564&33   & &    40&58 & 519&93 \vspace{0.5em}\\
    &\texttt{interp\_2d\_ad}                             & 140&44 & 298&13   & &   145&25 & 297&33 \\
    &\texttt{lpoly\_ad}                                  &   8&42 &  63&68   & &     8&01 &  64&56 \\
    &\texttt{lpoly}                                      &   6&94 &  24&17   & &   \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    &\texttt{find\_random\_index}                        &  17&86 &   0&00   & &   \multicolumn{2}{c}{-} & \multicolumn{2}{c}{-} \\
    \hline
  \end{tabular}
  \caption{IBM CloudScatter Adjoint model profile results for the \texttt{Get\_Cloud\_Opt\_IR\_AD} subroutine. All times in seconds.}
  \label{tab:ad_cs_test_get_cloud_opt_ir_ibm}
\end{table}

